<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>
  Top Level Namespace
  
    &mdash; Documentation by YARD 0.8.7.4
  
</title>

  <link rel="stylesheet" href="css/style.css" type="text/css" charset="utf-8" />

  <link rel="stylesheet" href="css/common.css" type="text/css" charset="utf-8" />

<script type="text/javascript" charset="utf-8">
  hasFrames = window.top.frames.main ? true : false;
  relpath = '';
  framesUrl = "frames.html#!top-level-namespace.html";
</script>


  <script type="text/javascript" charset="utf-8" src="js/jquery.js"></script>

  <script type="text/javascript" charset="utf-8" src="js/app.js"></script>


  </head>
  <body>
    <div id="header">
      <div id="menu">
  
    <a href="_index.html">Index</a> &raquo;
    
    
    <span class="title">Top Level Namespace</span>
  

  <div class="noframes"><span class="title">(</span><a href="." target="_top">no frames</a><span class="title">)</span></div>
</div>

      <div id="search">
  
    <a class="full_list_link" id="puppet_manifest_list_link"
        href="puppet_manifest_list.html">
      Puppet Manifest List
    </a>
  
    <a class="full_list_link" id="puppet_plugin_list_link"
        href="puppet_plugin_list.html">
      Puppet Plugin List
    </a>
  
    <a class="full_list_link" id="puppet_type_list_link"
        href="puppet_type_list.html">
      Puppet Type List
    </a>
  
    <a class="full_list_link" id="puppet_provider_list_link"
        href="puppet_provider_list.html">
      Puppet Provider List
    </a>
  
    <a class="full_list_link" id="class_list_link"
        href="class_list.html">
      Class List
    </a>
  
    <a class="full_list_link" id="method_list_link"
        href="method_list.html">
      Method List
    </a>
  
    <a class="full_list_link" id="file_list_link"
        href="file_list.html">
      File List
    </a>
  
</div>
      <div class="clear"></div>
    </div>

    <iframe id="search_frame"></iframe>

    <div id="content"><h1>Top Level Namespace
  
  
  
</h1>

<dl class="box">
  
  
    
  
    
  
  
  
</dl>
<div class="clear"></div>

<h2>Defined Under Namespace</h2>
<p class="children">
  
    
  
    
      <strong class="classes">Classes:</strong> <span class='object_link'><a href="DNSEntry.html" title="DNSEntry (class)">DNSEntry</a></span>, <span class='object_link'><a href="DNSZone.html" title="DNSZone (class)">DNSZone</a></span>, <span class='object_link'><a href="IPAddr.html" title="IPAddr (class)">IPAddr</a></span>
    
  
</p>

  <h2>Constant Summary</h2>
  
    <dl class="constants">
      
        <dt id="NODESET_BIN-constant" class="">NODESET_BIN =
          
        </dt>
        <dd><pre class="code"><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>/usr/bin/nodeset</span><span class='tstring_end'>&#39;</span></span></pre></dd>
      
    </dl>
  







  
    <h2>
      Instance Method Summary
      <small>(<a href="#" class="summary_toggle">collapse</a>)</small>
    </h2>

    <ul class="summary">
      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#add_entries-instance_method" title="#add_entries (instance method)">- (Object) <strong>add_entries</strong>(local_zone, reverse_zones, hostname, fqdn, ip) </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#decryptor-instance_method" title="#decryptor (instance method)">- (Object) <strong>decryptor</strong>(file, password, scheme = &#39;AES-256-CBC&#39;) </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#find_reverse_zone-instance_method" title="#find_reverse_zone (instance method)">- (Object) <strong>find_reverse_zone</strong>(zones, ip) </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#get_cluster_prefix-instance_method" title="#get_cluster_prefix (instance method)">- (Object) <strong>get_cluster_prefix</strong> </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#get_domain-instance_method" title="#get_domain (instance method)">- (Object) <strong>get_domain</strong> </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#get_hiera-instance_method" title="#get_hiera (instance method)">- (Object) <strong>get_hiera</strong>(key) </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#get_host_vip_notify_scripts-instance_method" title="#get_host_vip_notify_scripts (instance method)">- (Object) <strong>get_host_vip_notify_scripts</strong>(hostname) </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#get_host_vips-instance_method" title="#get_host_vips (instance method)">- (Object) <strong>get_host_vips</strong>(hostname) </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#get_host_vservs-instance_method" title="#get_host_vservs (instance method)">- (Object) <strong>get_host_vservs</strong>(hostname) </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#get_hosts_by_profile-instance_method" title="#get_hosts_by_profile (instance method)">- (Object) <strong>get_hosts_by_profile</strong>(profile) </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#get_hosts_by_role-instance_method" title="#get_hosts_by_role (instance method)">- (Object) <strong>get_hosts_by_role</strong>(role) </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#get_master_network-instance_method" title="#get_master_network (instance method)">- (Object) <strong>get_master_network</strong> </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#get_network_topology-instance_method" title="#get_network_topology (instance method)">- (Object) <strong>get_network_topology</strong> </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#get_networks_reverse_zones-instance_method" title="#get_networks_reverse_zones (instance method)">- (Object) <strong>get_networks_reverse_zones</strong>(nets_topo) </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>Returns the array of IPAddr to consider for reverse zones out of the network topology given in parameter.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#get_profiles_by_role-instance_method" title="#get_profiles_by_role (instance method)">- (Object) <strong>get_profiles_by_role</strong>(role) </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#get_reverse_zone_name-instance_method" title="#get_reverse_zone_name (instance method)">- (Object) <strong>get_reverse_zone_name</strong>(ip) </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>Returns the reverse zone name corresponding to an ipaddr.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#get_reverse_zone_owner-instance_method" title="#get_reverse_zone_owner (instance method)">- (Object) <strong>get_reverse_zone_owner</strong>(ip, net) </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>Returns the reverse zone entry owner inside the network.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#get_role_by_hostname-instance_method" title="#get_role_by_hostname (instance method)">- (Object) <strong>get_role_by_hostname</strong>(hostname) </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#get_role_index_for_name-instance_method" title="#get_role_index_for_name (instance method)">- (Object) <strong>get_role_index_for_name</strong>(hostname, prefix) </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#get_vips-instance_method" title="#get_vips (instance method)">- (Object) <strong>get_vips</strong> </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>Return the vips hash found in hiera.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#hpc_atoh-instance_method" title="#hpc_atoh (instance method)">- (Object) <strong>hpc_atoh</strong>(array) </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>Transform the array into hash with empty values.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#hpc_dns_zones-instance_method" title="#hpc_dns_zones (instance method)">- (Object) <strong>hpc_dns_zones</strong> </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>A hash of DNS zones hashes of the cluster.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#hpc_ha_vip_notify_scripts-instance_method" title="#hpc_ha_vip_notify_scripts (instance method)">- (Object) <strong>hpc_ha_vip_notify_scripts</strong> </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>A hash of VIP notify scripts hash for the current host.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#hpc_ha_vips-instance_method" title="#hpc_ha_vips (instance method)">- (Object) <strong>hpc_ha_vips</strong> </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>A hash of VIP hash for the current host.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#hpc_ha_vservs-instance_method" title="#hpc_ha_vservs (instance method)">- (Object) <strong>hpc_ha_vservs</strong> </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>A list of vserv hash for the current host.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#hpc_hmap-instance_method" title="#hpc_hmap (instance method)">- (Object) <strong>hpc_hmap</strong>(hash, key) </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>Transform a hash of values into a hash of hash.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#hpc_nodeset_exec-instance_method" title="#hpc_nodeset_exec (instance method)">- (Object) <strong>hpc_nodeset_exec</strong>(params) </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#hpc_nodeset_expand-instance_method" title="#hpc_nodeset_expand (instance method)">- (Object) <strong>hpc_nodeset_expand</strong>(nodeset) </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#hpc_nodeset_fold-instance_method" title="#hpc_nodeset_fold (instance method)">- (Object) <strong>hpc_nodeset_fold</strong>(nodes_array) </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#hpc_roles_nodeset-instance_method" title="#hpc_roles_nodeset (instance method)">- (Object) <strong>hpc_roles_nodeset</strong>(roles = nil) </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>A hash with role names as keys and nodeset expression as value.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#hpc_roles_single_nodeset-instance_method" title="#hpc_roles_single_nodeset (instance method)">- (Object) <strong>hpc_roles_single_nodeset</strong>(roles = nil) </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>A nodeset expression with all the hosts having selected roles.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#hpc_shorewall_interfaces-instance_method" title="#hpc_shorewall_interfaces (instance method)">- (Object) <strong>hpc_shorewall_interfaces</strong> </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>A hash with interfaces has key and a hash <code>{ &#39;zone&#39; =&gt; &#39;&lt;firewall_zone&#39;}</code> as value.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#hpc_source_file-instance_method" title="#hpc_source_file (instance method)">- (Object) <strong>hpc_source_file</strong>(source) </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#roles-instance_method" title="#roles (instance method)">- (Object) <strong>roles</strong> </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
    </ul>
  



  <div id="instance_method_details" class="method_details_list">
    <h2>Instance Method Details</h2>

    
      <h1>Method: #add_entries</h1>
<div class="box_info">
  <dl>
    <dt class="">Defined in:</dt>
    <dd class="">
    lib/hpc/dns.rb
    </dd>
  </dl>
</div>

<div class="method_details_list">
  <div id="method_details">
    <h3 class="signature first" id="add_entries-instance_method">
  
    - (<tt>Object</tt>) <strong>add_entries</strong>(local_zone, reverse_zones, hostname, fqdn, ip) 
  

  

  
</h3><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


224
225
226
227
228
229
230
231
232
233
234</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/hpc/dns.rb', line 224</span>

<span class='kw'>def</span> <span class='id identifier rubyid_add_entries'>add_entries</span><span class='lparen'>(</span><span class='id identifier rubyid_local_zone'>local_zone</span><span class='comma'>,</span> <span class='id identifier rubyid_reverse_zones'>reverse_zones</span><span class='comma'>,</span> <span class='id identifier rubyid_hostname'>hostname</span><span class='comma'>,</span> <span class='id identifier rubyid_fqdn'>fqdn</span><span class='comma'>,</span> <span class='id identifier rubyid_ip'>ip</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_local_zone'>local_zone</span><span class='period'>.</span><span class='id identifier rubyid_add_entry'>add_entry</span><span class='lparen'>(</span><span class='id identifier rubyid_hostname'>hostname</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>IN</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>A</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='id identifier rubyid_ip'>ip</span><span class='period'>.</span><span class='id identifier rubyid_to_s'>to_s</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_reverse_zone'>reverse_zone</span> <span class='op'>=</span> <span class='id identifier rubyid_find_reverse_zone'>find_reverse_zone</span><span class='lparen'>(</span><span class='id identifier rubyid_reverse_zones'>reverse_zones</span><span class='comma'>,</span> <span class='id identifier rubyid_ip'>ip</span><span class='rparen'>)</span>
  <span class='kw'>if</span> <span class='id identifier rubyid_reverse_zone'>reverse_zone</span><span class='period'>.</span><span class='id identifier rubyid_nil?'>nil?</span>
    <span class='id identifier rubyid_puts'>puts</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>unable to find reverse zone for IP </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_ip'>ip</span><span class='period'>.</span><span class='id identifier rubyid_to_s'>to_s</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span>
    <span class='comment'># do nothing
</span>  <span class='kw'>else</span>
    <span class='id identifier rubyid_owner'>owner</span> <span class='op'>=</span> <span class='id identifier rubyid_get_reverse_zone_owner'>get_reverse_zone_owner</span><span class='lparen'>(</span><span class='id identifier rubyid_ip'>ip</span><span class='comma'>,</span> <span class='id identifier rubyid_reverse_zone'>reverse_zone</span><span class='period'>.</span><span class='id identifier rubyid_net'>net</span><span class='rparen'>)</span>
    <span class='id identifier rubyid_reverse_zone'>reverse_zone</span><span class='period'>.</span><span class='id identifier rubyid_add_entry'>add_entry</span><span class='lparen'>(</span><span class='id identifier rubyid_owner'>owner</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>IN</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>PTR</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='id identifier rubyid_fqdn'>fqdn</span><span class='rparen'>)</span>
  <span class='kw'>end</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
  </div>
</div>
    
      <h1>Method: #decryptor</h1>
<div class="box_info">
  <dl>
    <dt class="">Defined in:</dt>
    <dd class="">
    lib/puppet/parser/functions/decrypt.rb
    </dd>
  </dl>
</div>

<div class="method_details_list">
  <div id="method_details">
    <h3 class="signature first" id="decryptor-instance_method">
  
    - (<tt>Object</tt>) <strong>decryptor</strong>(file, password, scheme = &#39;AES-256-CBC&#39;) 
  

  

  
</h3><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/puppet/parser/functions/decrypt.rb', line 5</span>

<span class='kw'>def</span> <span class='id identifier rubyid_decryptor'>decryptor</span><span class='lparen'>(</span><span class='id identifier rubyid_file'>file</span><span class='comma'>,</span> <span class='id identifier rubyid_password'>password</span><span class='comma'>,</span> <span class='id identifier rubyid_scheme'>scheme</span><span class='op'>=</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>AES-256-CBC</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span>

  <span class='comment'>### Define key and iv lenght according to the RC4 encryption scheme ###
</span>  <span class='kw'>case</span> <span class='id identifier rubyid_scheme'>scheme</span>
    <span class='kw'>when</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>AES-256-CBC</span><span class='tstring_end'>&#39;</span></span>
      <span class='id identifier rubyid_keylength'>keylength</span><span class='op'>=</span><span class='int'>32</span>
      <span class='id identifier rubyid_ivlength'>ivlength</span><span class='op'>=</span><span class='int'>16</span>
    <span class='kw'>when</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>AES-192-CBC</span><span class='tstring_end'>&#39;</span></span>
      <span class='id identifier rubyid_keylength'>keylength</span><span class='op'>=</span><span class='int'>24</span>
      <span class='id identifier rubyid_ivlength'>ivlength</span><span class='op'>=</span><span class='int'>16</span>
    <span class='kw'>when</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>AES-128-CBC</span><span class='tstring_end'>&#39;</span></span>
      <span class='id identifier rubyid_keylength'>keylength</span><span class='op'>=</span><span class='int'>16</span>
      <span class='id identifier rubyid_ivlength'>ivlength</span><span class='op'>=</span><span class='int'>16</span>
  <span class='kw'>end</span>

  <span class='id identifier rubyid_encrypted_data'>encrypted_data</span> <span class='op'>=</span> <span class='id identifier rubyid_hpc_source_file'>hpc_source_file</span><span class='lparen'>(</span><span class='id identifier rubyid_file'>file</span><span class='rparen'>)</span>

  <span class='kw'>if</span> <span class='id identifier rubyid_encrypted_data'>encrypted_data</span> <span class='op'>==</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_end'>&#39;</span></span>
    <span class='id identifier rubyid_raise'>raise</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Failed to read encrypted data from any source: </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_file'>file</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span>
  <span class='kw'>end</span>

  <span class='kw'>if</span> <span class='id identifier rubyid_encrypted_data'>encrypted_data</span><span class='period'>.</span><span class='id identifier rubyid_length'>length</span> <span class='op'>&gt;</span> <span class='int'>16</span> <span class='kw'>or</span> <span class='id identifier rubyid_encrypted_data'>encrypted_data</span><span class='lbracket'>[</span><span class='int'>0</span><span class='comma'>,</span> <span class='int'>8</span><span class='rbracket'>]</span> <span class='op'>==</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Salted__</span><span class='tstring_end'>&#39;</span></span>
    <span class='comment'># the unpack/pack trick is here to avoid an encoding issue
</span>    <span class='comment'># when using the salt in the MD5::digest. Not sufficiently
</span>    <span class='comment'># an expert on ruby string encoding to entirely understand
</span>    <span class='comment'># what&#39;s going on here.
</span>    <span class='id identifier rubyid_encrypted_data'>encrypted_data</span> <span class='op'>=</span> <span class='id identifier rubyid_encrypted_data'>encrypted_data</span><span class='period'>.</span><span class='id identifier rubyid_unpack'>unpack</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>c*</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_pack'>pack</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>c*</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span>
    <span class='id identifier rubyid_salt'>salt</span> <span class='op'>=</span> <span class='id identifier rubyid_encrypted_data'>encrypted_data</span><span class='lbracket'>[</span><span class='int'>8</span><span class='comma'>,</span> <span class='int'>8</span><span class='rbracket'>]</span>
    <span class='id identifier rubyid_encrypted_data_without_salt'>encrypted_data_without_salt</span> <span class='op'>=</span> <span class='id identifier rubyid_encrypted_data'>encrypted_data</span><span class='lbracket'>[</span><span class='int'>16</span><span class='op'>..</span><span class='op'>-</span><span class='int'>1</span><span class='rbracket'>]</span>
    <span class='id identifier rubyid_totsize'>totsize</span> <span class='op'>=</span> <span class='id identifier rubyid_keylength'>keylength</span> <span class='op'>+</span> <span class='id identifier rubyid_ivlength'>ivlength</span>
    <span class='id identifier rubyid_keyivdata'>keyivdata</span> <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_end'>&#39;</span></span>
    <span class='id identifier rubyid_temp'>temp</span> <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_end'>&#39;</span></span>
    <span class='kw'>while</span> <span class='id identifier rubyid_keyivdata'>keyivdata</span><span class='period'>.</span><span class='id identifier rubyid_length'>length</span> <span class='op'>&lt;</span> <span class='id identifier rubyid_totsize'>totsize</span> <span class='kw'>do</span>
      <span class='id identifier rubyid_temp'>temp</span> <span class='op'>=</span> <span class='const'>Digest</span><span class='op'>::</span><span class='const'>MD5</span><span class='period'>.</span><span class='id identifier rubyid_digest'>digest</span><span class='lparen'>(</span><span class='id identifier rubyid_temp'>temp</span> <span class='op'>+</span> <span class='id identifier rubyid_password'>password</span> <span class='op'>+</span> <span class='id identifier rubyid_salt'>salt</span><span class='rparen'>)</span>
      <span class='id identifier rubyid_keyivdata'>keyivdata</span> <span class='op'>&lt;&lt;</span> <span class='id identifier rubyid_temp'>temp</span>
    <span class='kw'>end</span>
    <span class='id identifier rubyid_key'>key</span> <span class='op'>=</span> <span class='id identifier rubyid_keyivdata'>keyivdata</span><span class='lbracket'>[</span><span class='int'>0</span><span class='comma'>,</span> <span class='id identifier rubyid_keylength'>keylength</span><span class='rbracket'>]</span>
    <span class='id identifier rubyid_iv'>iv</span>  <span class='op'>=</span> <span class='id identifier rubyid_keyivdata'>keyivdata</span><span class='lbracket'>[</span><span class='id identifier rubyid_keylength'>keylength</span><span class='comma'>,</span> <span class='id identifier rubyid_ivlength'>ivlength</span><span class='rbracket'>]</span>

    <span class='comment'>### Decrypt data ###
</span>    <span class='id identifier rubyid_decipher'>decipher</span> <span class='op'>=</span> <span class='const'>OpenSSL</span><span class='op'>::</span><span class='const'>Cipher</span><span class='op'>::</span><span class='const'>Cipher</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span><span class='lparen'>(</span><span class='id identifier rubyid_scheme'>scheme</span><span class='rparen'>)</span>
    <span class='id identifier rubyid_decipher'>decipher</span><span class='period'>.</span><span class='id identifier rubyid_decrypt'>decrypt</span>
    <span class='id identifier rubyid_decipher'>decipher</span><span class='period'>.</span><span class='id identifier rubyid_key'>key</span> <span class='op'>=</span> <span class='id identifier rubyid_key'>key</span>
    <span class='id identifier rubyid_decipher'>decipher</span><span class='period'>.</span><span class='id identifier rubyid_iv'>iv</span> <span class='op'>=</span> <span class='id identifier rubyid_iv'>iv</span>
    <span class='id identifier rubyid_result'>result</span> <span class='op'>=</span> <span class='id identifier rubyid_decipher'>decipher</span><span class='period'>.</span><span class='id identifier rubyid_update'>update</span><span class='lparen'>(</span><span class='id identifier rubyid_encrypted_data_without_salt'>encrypted_data_without_salt</span><span class='rparen'>)</span> <span class='op'>+</span> <span class='id identifier rubyid_decipher'>decipher</span><span class='period'>.</span><span class='id identifier rubyid_final'>final</span>
    <span class='kw'>return</span> <span class='id identifier rubyid_result'>result</span>
  <span class='kw'>else</span>
    <span class='id identifier rubyid_raise'>raise</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Invalid encrypted data read from file: </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_file'>file</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span>
  <span class='kw'>end</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
  </div>
</div>
    
      <h1>Method: #find_reverse_zone</h1>
<div class="box_info">
  <dl>
    <dt class="">Defined in:</dt>
    <dd class="">
    lib/hpc/dns.rb
    </dd>
  </dl>
</div>

<div class="method_details_list">
  <div id="method_details">
    <h3 class="signature first" id="find_reverse_zone-instance_method">
  
    - (<tt>Object</tt>) <strong>find_reverse_zone</strong>(zones, ip) 
  

  

  
</h3><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


215
216
217
218
219
220
221
222</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/hpc/dns.rb', line 215</span>

<span class='kw'>def</span> <span class='id identifier rubyid_find_reverse_zone'>find_reverse_zone</span><span class='lparen'>(</span><span class='id identifier rubyid_zones'>zones</span><span class='comma'>,</span> <span class='id identifier rubyid_ip'>ip</span><span class='rparen'>)</span> 
  <span class='id identifier rubyid_zones'>zones</span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_zone'>zone</span><span class='op'>|</span>
    <span class='kw'>if</span> <span class='id identifier rubyid_zone'>zone</span><span class='period'>.</span><span class='id identifier rubyid_net'>net</span><span class='period'>.</span><span class='id identifier rubyid_include?'>include?</span><span class='lparen'>(</span><span class='id identifier rubyid_ip'>ip</span><span class='rparen'>)</span>
      <span class='kw'>return</span> <span class='id identifier rubyid_zone'>zone</span>
    <span class='kw'>end</span>
  <span class='kw'>end</span>
  <span class='kw'>return</span> <span class='kw'>nil</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
  </div>
</div>
    
      <h1>Method: #get_cluster_prefix</h1>
<div class="box_info">
  <dl>
    <dt class="">Defined in:</dt>
    <dd class="">
    lib/hpc/profiles.rb
    </dd>
  </dl>
</div>

<div class="method_details_list">
  <div id="method_details">
    <h3 class="signature first" id="get_cluster_prefix-instance_method">
  
    - (<tt>Object</tt>) <strong>get_cluster_prefix</strong> 
  

  

  
</h3><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


50
51
52
53
54
55
56
57
58</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/hpc/profiles.rb', line 50</span>

<span class='kw'>def</span> <span class='id identifier rubyid_get_cluster_prefix'>get_cluster_prefix</span><span class='lparen'>(</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_key'>key</span> <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>cluster_prefix</span><span class='tstring_end'>&#39;</span></span>
  <span class='id identifier rubyid_prefix'>prefix</span> <span class='op'>=</span> <span class='gvar'>$hiera</span><span class='period'>.</span><span class='id identifier rubyid_lookup'>lookup</span><span class='lparen'>(</span><span class='id identifier rubyid_key'>key</span><span class='comma'>,</span>
                         <span class='gvar'>$options</span><span class='lbracket'>[</span><span class='symbol'>:default</span><span class='rbracket'>]</span><span class='comma'>,</span>
                         <span class='gvar'>$options</span><span class='lbracket'>[</span><span class='symbol'>:scope</span><span class='rbracket'>]</span><span class='comma'>,</span>
                         <span class='kw'>nil</span><span class='comma'>,</span>
                         <span class='gvar'>$options</span><span class='lbracket'>[</span><span class='symbol'>:resolution_type</span><span class='rbracket'>]</span><span class='rparen'>)</span>
  <span class='kw'>return</span> <span class='id identifier rubyid_prefix'>prefix</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
  </div>
</div>
    
      <h1>Method: #get_domain</h1>
<div class="box_info">
  <dl>
    <dt class="">Defined in:</dt>
    <dd class="">
    lib/hpc/dns.rb
    </dd>
  </dl>
</div>

<div class="method_details_list">
  <div id="method_details">
    <h3 class="signature first" id="get_domain-instance_method">
  
    - (<tt>Object</tt>) <strong>get_domain</strong> 
  

  

  
</h3><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


157
158
159</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/hpc/dns.rb', line 157</span>

<span class='kw'>def</span> <span class='id identifier rubyid_get_domain'>get_domain</span><span class='lparen'>(</span><span class='rparen'>)</span>
  <span class='kw'>return</span> <span class='id identifier rubyid_get_hiera'>get_hiera</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>domain</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
  </div>
</div>
    
      <h1>Method: #get_hiera</h1>
<div class="box_info">
  <dl>
    <dt class="">Defined in:</dt>
    <dd class="">
    lib/hpc/dns.rb
    </dd>
  </dl>
</div>

<div class="method_details_list">
  <div id="method_details">
    <h3 class="signature first" id="get_hiera-instance_method">
  
    - (<tt>Object</tt>) <strong>get_hiera</strong>(key) 
  

  

  
</h3><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


149
150
151
152
153
154
155</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/hpc/dns.rb', line 149</span>

<span class='kw'>def</span> <span class='id identifier rubyid_get_hiera'>get_hiera</span><span class='lparen'>(</span><span class='id identifier rubyid_key'>key</span><span class='rparen'>)</span>
  <span class='kw'>return</span> <span class='gvar'>$hiera</span><span class='period'>.</span><span class='id identifier rubyid_lookup'>lookup</span><span class='lparen'>(</span><span class='id identifier rubyid_key'>key</span><span class='comma'>,</span>
                       <span class='gvar'>$options</span><span class='lbracket'>[</span><span class='symbol'>:default</span><span class='rbracket'>]</span><span class='comma'>,</span>
                       <span class='gvar'>$options</span><span class='lbracket'>[</span><span class='symbol'>:scope</span><span class='rbracket'>]</span><span class='comma'>,</span>
                       <span class='kw'>nil</span><span class='comma'>,</span>
                       <span class='gvar'>$options</span><span class='lbracket'>[</span><span class='symbol'>:resolution_type</span><span class='rbracket'>]</span><span class='rparen'>)</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
  </div>
</div>
    
      <h1>Method: #get_host_vip_notify_scripts</h1>
<div class="box_info">
  <dl>
    <dt class="">Defined in:</dt>
    <dd class="">
    lib/hpc/ha.rb
    </dd>
  </dl>
</div>

<div class="method_details_list">
  <div id="method_details">
    <h3 class="signature first" id="get_host_vip_notify_scripts-instance_method">
  
    - (<tt>Object</tt>) <strong>get_host_vip_notify_scripts</strong>(hostname) 
  

  

  
</h3><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119
120
121
122
123
124
125
126
127
128
129
130</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/hpc/ha.rb', line 104</span>

<span class='kw'>def</span> <span class='id identifier rubyid_get_host_vip_notify_scripts'>get_host_vip_notify_scripts</span><span class='lparen'>(</span><span class='id identifier rubyid_hostname'>hostname</span><span class='rparen'>)</span>

  <span class='comment'># This function returns a hash that could be given in parameters of:
</span>  <span class='comment'>#   create_resources(hpc_ha::vip_notify_script, $result)
</span>
  <span class='id identifier rubyid_host_vip_notify_scripts'>host_vip_notify_scripts</span> <span class='op'>=</span> <span class='const'>Hash</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span>

  <span class='comment'># Iterate over all VIPs found in hiera. For each of them, if hostname is
</span>  <span class='comment'># member, add to host_vips
</span>  <span class='id identifier rubyid_all_vips'>all_vips</span> <span class='op'>=</span> <span class='id identifier rubyid_get_vips'>get_vips</span><span class='lparen'>(</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_all_vips'>all_vips</span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_vip_group'>vip_group</span><span class='comma'>,</span> <span class='id identifier rubyid_vip_items'>vip_items</span><span class='op'>|</span>

    <span class='id identifier rubyid_members'>members</span> <span class='op'>=</span> <span class='id identifier rubyid_hpc_nodeset_expand'>hpc_nodeset_expand</span><span class='lparen'>(</span><span class='id identifier rubyid_vip_items'>vip_items</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>members</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span><span class='rparen'>)</span>
    <span class='kw'>if</span> <span class='id identifier rubyid_members'>members</span><span class='period'>.</span><span class='id identifier rubyid_include?'>include?</span><span class='lparen'>(</span><span class='id identifier rubyid_hostname'>hostname</span><span class='rparen'>)</span> <span class='kw'>and</span> <span class='id identifier rubyid_vip_items'>vip_items</span><span class='period'>.</span><span class='id identifier rubyid_key?'>key?</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>notify</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span>

      <span class='id identifier rubyid_new_script'>new_script</span> <span class='op'>=</span> <span class='const'>Hash</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span>
      <span class='comment'># The items in this hash must correspond to the parameters of the
</span>      <span class='comment'># hpc_ha::vip_notify_script class
</span>      <span class='id identifier rubyid_new_script'>new_script</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>vip_name</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='id identifier rubyid_vip_group'>vip_group</span>
      <span class='id identifier rubyid_new_script'>new_script</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>source</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='id identifier rubyid_vip_items'>vip_items</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>notify</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span>

      <span class='id identifier rubyid_host_vip_notify_scripts'>host_vip_notify_scripts</span><span class='lbracket'>[</span><span class='id identifier rubyid_vip_group'>vip_group</span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='id identifier rubyid_new_script'>new_script</span>
    <span class='kw'>end</span>
  <span class='kw'>end</span>
  <span class='kw'>return</span> <span class='kw'>nil</span> <span class='kw'>unless</span> <span class='id identifier rubyid_host_vip_notify_scripts'>host_vip_notify_scripts</span><span class='period'>.</span><span class='id identifier rubyid_length'>length</span>
  <span class='kw'>return</span> <span class='id identifier rubyid_host_vip_notify_scripts'>host_vip_notify_scripts</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
  </div>
</div>
    
      <h1>Method: #get_host_vips</h1>
<div class="box_info">
  <dl>
    <dt class="">Defined in:</dt>
    <dd class="">
    lib/hpc/ha.rb
    </dd>
  </dl>
</div>

<div class="method_details_list">
  <div id="method_details">
    <h3 class="signature first" id="get_host_vips-instance_method">
  
    - (<tt>Object</tt>) <strong>get_host_vips</strong>(hostname) 
  

  

  
</h3><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
93
94
95
96
97
98
99
100
101
102</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/hpc/ha.rb', line 63</span>

<span class='kw'>def</span> <span class='id identifier rubyid_get_host_vips'>get_host_vips</span><span class='lparen'>(</span><span class='id identifier rubyid_hostname'>hostname</span><span class='rparen'>)</span>

  <span class='comment'># This function returns a hash that could be given in parameters of:
</span>  <span class='comment'>#   create_resources(hpc_ha::vip, $result)
</span>
  <span class='id identifier rubyid_host_vips'>host_vips</span> <span class='op'>=</span> <span class='const'>Hash</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span>
  <span class='id identifier rubyid_prefix'>prefix</span> <span class='op'>=</span> <span class='id identifier rubyid_get_cluster_prefix'>get_cluster_prefix</span><span class='lparen'>(</span><span class='rparen'>)</span>

  <span class='comment'># Iterate over all VIPs found in hiera. For each of them, if hostname is
</span>  <span class='comment'># member, add to host_vips
</span>  <span class='id identifier rubyid_all_vips'>all_vips</span> <span class='op'>=</span> <span class='id identifier rubyid_get_vips'>get_vips</span><span class='lparen'>(</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_all_vips'>all_vips</span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_vip_group'>vip_group</span><span class='comma'>,</span> <span class='id identifier rubyid_vip_items'>vip_items</span><span class='op'>|</span>

    <span class='id identifier rubyid_members'>members</span> <span class='op'>=</span> <span class='id identifier rubyid_hpc_nodeset_expand'>hpc_nodeset_expand</span><span class='lparen'>(</span><span class='id identifier rubyid_vip_items'>vip_items</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>members</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span><span class='rparen'>)</span>
    <span class='kw'>if</span> <span class='id identifier rubyid_members'>members</span><span class='period'>.</span><span class='id identifier rubyid_include?'>include?</span><span class='lparen'>(</span><span class='id identifier rubyid_hostname'>hostname</span><span class='rparen'>)</span>

      <span class='id identifier rubyid_is_master'>is_master</span> <span class='op'>=</span> <span class='id identifier rubyid_vip_items'>vip_items</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>master</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span> <span class='op'>==</span> <span class='id identifier rubyid_hostname'>hostname</span>
      <span class='id identifier rubyid_priority'>priority</span> <span class='op'>=</span> <span class='id identifier rubyid_is_master'>is_master</span> <span class='op'>?</span> <span class='int'>100</span> <span class='op'>:</span> <span class='int'>50</span>

      <span class='id identifier rubyid_new_vip'>new_vip</span> <span class='op'>=</span> <span class='const'>Hash</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span>
      <span class='comment'># The items in this hash must correspond to the parameters of the
</span>      <span class='comment'># hpc_ha::vip class
</span>      <span class='id identifier rubyid_new_vip'>new_vip</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>prefix</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='id identifier rubyid_prefix'>prefix</span>
      <span class='id identifier rubyid_new_vip'>new_vip</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>master</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='id identifier rubyid_is_master'>is_master</span>
      <span class='id identifier rubyid_new_vip'>new_vip</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>priority</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='id identifier rubyid_priority'>priority</span>
      <span class='id identifier rubyid_new_vip'>new_vip</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>net_id</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='id identifier rubyid_vip_items'>vip_items</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>network</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span>
      <span class='id identifier rubyid_new_vip'>new_vip</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>router_id</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='id identifier rubyid_vip_items'>vip_items</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>router_id</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span>
      <span class='id identifier rubyid_new_vip'>new_vip</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>ip_address</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='id identifier rubyid_vip_items'>vip_items</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>ip</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span>
      <span class='id identifier rubyid_new_vip'>new_vip</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>auth_secret</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='id identifier rubyid_vip_items'>vip_items</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>secret</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span>
      <span class='id identifier rubyid_new_vip'>new_vip</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>notify_script</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='id identifier rubyid_vip_items'>vip_items</span><span class='period'>.</span><span class='id identifier rubyid_key?'>key?</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>notify</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span>
      <span class='kw'>if</span> <span class='id identifier rubyid_vip_items'>vip_items</span><span class='period'>.</span><span class='id identifier rubyid_key?'>key?</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>advert_int</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span>
        <span class='id identifier rubyid_new_vip'>new_vip</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>advert_int</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='id identifier rubyid_vip_items'>vip_items</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>advert_int</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span>
      <span class='kw'>end</span>

      <span class='id identifier rubyid_host_vips'>host_vips</span><span class='lbracket'>[</span><span class='id identifier rubyid_vip_group'>vip_group</span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='id identifier rubyid_new_vip'>new_vip</span>
    <span class='kw'>end</span>
  <span class='kw'>end</span>
  <span class='kw'>return</span> <span class='kw'>nil</span> <span class='kw'>unless</span> <span class='id identifier rubyid_host_vips'>host_vips</span><span class='period'>.</span><span class='id identifier rubyid_length'>length</span>
  <span class='kw'>return</span> <span class='id identifier rubyid_host_vips'>host_vips</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
  </div>
</div>
    
      <h1>Method: #get_host_vservs</h1>
<div class="box_info">
  <dl>
    <dt class="">Defined in:</dt>
    <dd class="">
    lib/hpc/ha.rb
    </dd>
  </dl>
</div>

<div class="method_details_list">
  <div id="method_details">
    <h3 class="signature first" id="get_host_vservs-instance_method">
  
    - (<tt>Object</tt>) <strong>get_host_vservs</strong>(hostname) 
  

  

  
</h3><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


132
133
134
135
136
137
138
139
140
141
142
143
144
145
146
147
148
149
150
151
152
153
154
155
156
157
158
159
160
161
162
163
164
165
166
167
168
169
170
171
172
173
174</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/hpc/ha.rb', line 132</span>

<span class='kw'>def</span> <span class='id identifier rubyid_get_host_vservs'>get_host_vservs</span><span class='lparen'>(</span><span class='id identifier rubyid_hostname'>hostname</span><span class='rparen'>)</span>
  
  <span class='comment'># This function returns a hash that could be given in parameters of:
</span>  <span class='comment'>#   create_resources(hpc_ha::vservs, $result)
</span>
  <span class='id identifier rubyid_host_vservs'>host_vservs</span> <span class='op'>=</span> <span class='const'>Hash</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span>

  <span class='comment'># Find prefix for construct real hostname, for example if VIP is on &quot;wan&quot; real hostname isn&#39;t eofront1 but rineofront1
</span>  <span class='id identifier rubyid_net_topology'>net_topology</span> <span class='op'>=</span> <span class='const'>Facter</span><span class='period'>.</span><span class='id identifier rubyid_value'>value</span><span class='lparen'>(</span><span class='symbol'>:net_topology</span><span class='rparen'>)</span>

  <span class='comment'># Iterate over all VIPs found in hiera. For each of them, if hostname is
</span>  <span class='comment'># member, add to host_vips
</span>  <span class='id identifier rubyid_all_vservs'>all_vservs</span> <span class='op'>=</span> <span class='id identifier rubyid_get_vips'>get_vips</span><span class='lparen'>(</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_all_vservs'>all_vservs</span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_vservs_group'>vservs_group</span><span class='comma'>,</span> <span class='id identifier rubyid_vservs_items'>vservs_items</span><span class='op'>|</span>

    <span class='id identifier rubyid_members'>members</span> <span class='op'>=</span> <span class='id identifier rubyid_hpc_nodeset_expand'>hpc_nodeset_expand</span><span class='lparen'>(</span><span class='id identifier rubyid_vservs_items'>vservs_items</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>members</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span><span class='rparen'>)</span>
    <span class='id identifier rubyid_network_type'>network_type</span> <span class='op'>=</span> <span class='id identifier rubyid_vservs_items'>vservs_items</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>network</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span>
    <span class='id identifier rubyid_netmask'>netmask</span> <span class='op'>=</span> <span class='id identifier rubyid_net_topology'>net_topology</span><span class='lbracket'>[</span><span class='id identifier rubyid_network_type'>network_type</span><span class='rbracket'>]</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>prefix_length</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span>
    <span class='id identifier rubyid_ip'>ip</span> <span class='op'>=</span> <span class='id identifier rubyid_vservs_items'>vservs_items</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>ip</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span>
    <span class='id identifier rubyid_ip2'>ip2</span> <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_ip'>ip</span><span class='embexpr_end'>}</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_netmask'>netmask</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span>

    <span class='kw'>if</span> <span class='id identifier rubyid_members'>members</span><span class='period'>.</span><span class='id identifier rubyid_include?'>include?</span><span class='lparen'>(</span><span class='id identifier rubyid_hostname'>hostname</span><span class='rparen'>)</span> <span class='kw'>and</span> <span class='id identifier rubyid_vservs_items'>vservs_items</span><span class='period'>.</span><span class='id identifier rubyid_key?'>key?</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>port</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span>
      <span class='id identifier rubyid_new_vservs'>new_vservs</span> <span class='op'>=</span> <span class='const'>Hash</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span>
      <span class='comment'># The items in this hash must correspond to the parameters of the
</span>      <span class='comment'># hpc_ha::vserv class
</span>      <span class='id identifier rubyid_new_vservs'>new_vservs</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>vip_name</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='id identifier rubyid_vservs_group'>vservs_group</span>
      <span class='id identifier rubyid_new_vservs'>new_vservs</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>ip_address</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='id identifier rubyid_ip2'>ip2</span>
      <span class='id identifier rubyid_new_vservs'>new_vservs</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>port</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='id identifier rubyid_vservs_items'>vservs_items</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>port</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span>
      <span class='id identifier rubyid_new_vservs'>new_vservs</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>real_server_hosts</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='id identifier rubyid_members'>members</span>
      <span class='id identifier rubyid_new_vservs'>new_vservs</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>delay_loop</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='id identifier rubyid_vservs_items'>vservs_items</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>delay_loop</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span>
      <span class='id identifier rubyid_new_vservs'>new_vservs</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>persistence_timeout</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='id identifier rubyid_vservs_items'>vservs_items</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>persistence_timeout</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span>
      <span class='id identifier rubyid_new_vservs'>new_vservs</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>protocol</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='id identifier rubyid_vservs_items'>vservs_items</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>protocol</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span>
      <span class='id identifier rubyid_new_vservs'>new_vservs</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>options</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='const'>Hash</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span>
      <span class='id identifier rubyid_new_vservs'>new_vservs</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>options</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='id identifier rubyid_vservs_items'>vservs_items</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>options</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span>
      <span class='id identifier rubyid_new_vservs'>new_vservs</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>network</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='id identifier rubyid_vservs_items'>vservs_items</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>network</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span>
      <span class='id identifier rubyid_new_vservs'>new_vservs</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>prefixes</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='id identifier rubyid_net_topology'>net_topology</span><span class='lbracket'>[</span><span class='id identifier rubyid_network_type'>network_type</span><span class='rbracket'>]</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>prefixes</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span>
      <span class='id identifier rubyid_host_vservs'>host_vservs</span><span class='lbracket'>[</span><span class='id identifier rubyid_vservs_group'>vservs_group</span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='id identifier rubyid_new_vservs'>new_vservs</span>
    <span class='kw'>end</span>
  <span class='kw'>end</span>

  <span class='kw'>return</span> <span class='kw'>nil</span> <span class='kw'>unless</span> <span class='id identifier rubyid_host_vservs'>host_vservs</span><span class='period'>.</span><span class='id identifier rubyid_length'>length</span>
  <span class='kw'>return</span> <span class='id identifier rubyid_host_vservs'>host_vservs</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
  </div>
</div>
    
      <h1>Method: #get_hosts_by_profile</h1>
<div class="box_info">
  <dl>
    <dt class="">Defined in:</dt>
    <dd class="">
    lib/hpc/profiles.rb
    </dd>
  </dl>
</div>

<div class="method_details_list">
  <div id="method_details">
    <h3 class="signature first" id="get_hosts_by_profile-instance_method">
  
    - (<tt>Object</tt>) <strong>get_hosts_by_profile</strong>(profile) 
  

  

  
</h3><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


112
113
114
115
116
117
118
119
120
121
122
123
124
125
126
127
128</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/hpc/profiles.rb', line 112</span>

<span class='kw'>def</span> <span class='id identifier rubyid_get_hosts_by_profile'>get_hosts_by_profile</span><span class='lparen'>(</span><span class='id identifier rubyid_profile'>profile</span><span class='rparen'>)</span>
  <span class='comment'># To get the list of hosts having a particular profile, the function iterates
</span>  <span class='comment'># over the list of roles. For each role, it checks if the role includes the
</span>  <span class='comment'># given profile. If yes, the hosts of the role are appending to the resuling
</span>  <span class='comment'># array.
</span>  <span class='id identifier rubyid_hosts'>hosts</span> <span class='op'>=</span> <span class='const'>Array</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span>
  <span class='id identifier rubyid_roles'>roles</span> <span class='op'>=</span> <span class='id identifier rubyid_roles'>roles</span><span class='lparen'>(</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_full_profile_name'>full_profile_name</span> <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>profiles::</span><span class='tstring_end'>&#39;</span></span> <span class='op'>+</span> <span class='id identifier rubyid_profile'>profile</span>
  <span class='id identifier rubyid_roles'>roles</span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_role'>role</span><span class='op'>|</span>
    <span class='id identifier rubyid_profiles'>profiles</span> <span class='op'>=</span> <span class='id identifier rubyid_get_profiles_by_role'>get_profiles_by_role</span><span class='lparen'>(</span><span class='id identifier rubyid_role'>role</span><span class='rparen'>)</span>
    <span class='kw'>if</span> <span class='kw'>not</span> <span class='id identifier rubyid_profiles'>profiles</span><span class='period'>.</span><span class='id identifier rubyid_nil?'>nil?</span> <span class='kw'>and</span> <span class='id identifier rubyid_profiles'>profiles</span><span class='period'>.</span><span class='id identifier rubyid_include?'>include?</span><span class='lparen'>(</span><span class='id identifier rubyid_full_profile_name'>full_profile_name</span><span class='rparen'>)</span>
      <span class='id identifier rubyid_hosts'>hosts</span> <span class='op'>+=</span> <span class='id identifier rubyid_get_hosts_by_role'>get_hosts_by_role</span><span class='lparen'>(</span><span class='id identifier rubyid_role'>role</span><span class='rparen'>)</span>
    <span class='kw'>end</span>
  <span class='kw'>end</span>
  <span class='comment'># remove duplicates in the resulting array
</span>  <span class='kw'>return</span> <span class='id identifier rubyid_hosts'>hosts</span><span class='period'>.</span><span class='id identifier rubyid_uniq'>uniq</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
  </div>
</div>
    
      <h1>Method: #get_hosts_by_role</h1>
<div class="box_info">
  <dl>
    <dt class="">Defined in:</dt>
    <dd class="">
    lib/hpc/profiles.rb
    </dd>
  </dl>
</div>

<div class="method_details_list">
  <div id="method_details">
    <h3 class="signature first" id="get_hosts_by_role-instance_method">
  
    - (<tt>Object</tt>) <strong>get_hosts_by_role</strong>(role) 
  

  

  
</h3><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


101
102
103
104
105
106
107
108
109
110</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/hpc/profiles.rb', line 101</span>

<span class='kw'>def</span> <span class='id identifier rubyid_get_hosts_by_role'>get_hosts_by_role</span><span class='lparen'>(</span><span class='id identifier rubyid_role'>role</span><span class='rparen'>)</span>
  <span class='comment'># FIXME: ruby functions should not depend on facts
</span>  <span class='id identifier rubyid_hostlist'>hostlist</span> <span class='op'>=</span> <span class='const'>Facter</span><span class='period'>.</span><span class='id identifier rubyid_value'>value</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>hostfile</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span>
  <span class='id identifier rubyid_hosts'>hosts</span> <span class='op'>=</span> <span class='const'>Array</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span>
  <span class='id identifier rubyid_hostlist'>hostlist</span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_host'>host</span><span class='op'>|</span>
    <span class='id identifier rubyid_hostname'>hostname</span> <span class='op'>=</span> <span class='id identifier rubyid_host'>host</span><span class='lbracket'>[</span><span class='int'>0</span><span class='rbracket'>]</span>
    <span class='id identifier rubyid_hosts'>hosts</span><span class='period'>.</span><span class='id identifier rubyid_push'>push</span><span class='lparen'>(</span><span class='id identifier rubyid_hostname'>hostname</span><span class='rparen'>)</span> <span class='kw'>if</span> <span class='id identifier rubyid_get_role_by_hostname'>get_role_by_hostname</span><span class='lparen'>(</span><span class='id identifier rubyid_hostname'>hostname</span><span class='rparen'>)</span> <span class='op'>==</span> <span class='id identifier rubyid_role'>role</span>
  <span class='kw'>end</span>
  <span class='kw'>return</span> <span class='id identifier rubyid_hosts'>hosts</span> 
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
  </div>
</div>
    
      <h1>Method: #get_master_network</h1>
<div class="box_info">
  <dl>
    <dt class="">Defined in:</dt>
    <dd class="">
    lib/hpc/dns.rb
    </dd>
  </dl>
</div>

<div class="method_details_list">
  <div id="method_details">
    <h3 class="signature first" id="get_master_network-instance_method">
  
    - (<tt>Object</tt>) <strong>get_master_network</strong> 
  

  

  
</h3><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


161
162
163</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/hpc/dns.rb', line 161</span>

<span class='kw'>def</span> <span class='id identifier rubyid_get_master_network'>get_master_network</span><span class='lparen'>(</span><span class='rparen'>)</span>
  <span class='kw'>return</span> <span class='id identifier rubyid_get_hiera'>get_hiera</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>master_network</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
  </div>
</div>
    
      <h1>Method: #get_network_topology</h1>
<div class="box_info">
  <dl>
    <dt class="">Defined in:</dt>
    <dd class="">
    lib/hpc/dns.rb
    </dd>
  </dl>
</div>

<div class="method_details_list">
  <div id="method_details">
    <h3 class="signature first" id="get_network_topology-instance_method">
  
    - (<tt>Object</tt>) <strong>get_network_topology</strong> 
  

  

  
</h3><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


165
166
167</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/hpc/dns.rb', line 165</span>

<span class='kw'>def</span> <span class='id identifier rubyid_get_network_topology'>get_network_topology</span><span class='lparen'>(</span><span class='rparen'>)</span>
  <span class='kw'>return</span> <span class='id identifier rubyid_get_hiera'>get_hiera</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>net_topology</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
  </div>
</div>
    
      <h1>Method: #get_networks_reverse_zones</h1>
<div class="box_info">
  <dl>
    <dt class="">Defined in:</dt>
    <dd class="">
    lib/hpc/dns.rb
    </dd>
  </dl>
</div>

<div class="method_details_list">
  <div id="method_details">
    <h3 class="signature first" id="get_networks_reverse_zones-instance_method">
  
    - (<tt>Object</tt>) <strong>get_networks_reverse_zones</strong>(nets_topo) 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    <p>Returns the array of IPAddr to consider for reverse zones out of the network
topology given in parameter.</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


171
172
173
174
175
176
177
178
179
180
181
182
183
184
185
186
187
188
189
190
191
192
193
194
195
196
197</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/hpc/dns.rb', line 171</span>

<span class='kw'>def</span> <span class='id identifier rubyid_get_networks_reverse_zones'>get_networks_reverse_zones</span><span class='lparen'>(</span><span class='id identifier rubyid_nets_topo'>nets_topo</span><span class='rparen'>)</span>

  <span class='id identifier rubyid_networks'>networks</span> <span class='op'>=</span> <span class='const'>Array</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span>

  <span class='id identifier rubyid_nets_topo'>nets_topo</span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_net_name'>net_name</span><span class='comma'>,</span> <span class='id identifier rubyid_params'>params</span><span class='op'>|</span>

    <span class='id identifier rubyid_addr'>addr</span> <span class='op'>=</span> <span class='id identifier rubyid_params'>params</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>ipnetwork</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span>
    <span class='comment'># get cidr prefix length w/o leading slash and convert to int
</span>    <span class='id identifier rubyid_prefix'>prefix</span> <span class='op'>=</span> <span class='id identifier rubyid_params'>params</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>prefix_length</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span><span class='lbracket'>[</span><span class='int'>1</span><span class='op'>..</span><span class='op'>-</span><span class='int'>1</span><span class='rbracket'>]</span>
    <span class='id identifier rubyid_cidr'>cidr</span> <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_addr'>addr</span><span class='embexpr_end'>}</span><span class='tstring_content'>/</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_prefix'>prefix</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span>
    <span class='id identifier rubyid_ipnet'>ipnet</span> <span class='op'>=</span> <span class='const'>IPAddr</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span><span class='lparen'>(</span><span class='id identifier rubyid_cidr'>cidr</span><span class='rparen'>)</span>
    <span class='comment'># get all /24 subnets of this network
</span>    <span class='id identifier rubyid_subnets'>subnets</span> <span class='op'>=</span> <span class='id identifier rubyid_ipnet'>ipnet</span><span class='period'>.</span><span class='id identifier rubyid_subnets'>subnets</span>

    <span class='id identifier rubyid_subnets'>subnets</span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_subnet'>subnet</span><span class='op'>|</span>
      <span class='comment'># Check if network is not already included in any other networks
</span>      <span class='id identifier rubyid_add_network'>add_network</span> <span class='op'>=</span> <span class='kw'>true</span>
      <span class='id identifier rubyid_networks'>networks</span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_network'>network</span><span class='op'>|</span>
        <span class='id identifier rubyid_add_network'>add_network</span> <span class='op'>=</span> <span class='kw'>false</span> <span class='kw'>if</span> <span class='id identifier rubyid_network'>network</span><span class='period'>.</span><span class='id identifier rubyid_include?'>include?</span><span class='lparen'>(</span><span class='id identifier rubyid_subnet'>subnet</span><span class='rparen'>)</span>
      <span class='kw'>end</span>
      <span class='id identifier rubyid_networks'>networks</span> <span class='op'>&lt;&lt;</span> <span class='id identifier rubyid_subnet'>subnet</span> <span class='kw'>if</span> <span class='id identifier rubyid_add_network'>add_network</span>
    <span class='kw'>end</span>

  <span class='kw'>end</span>
  <span class='kw'>return</span> <span class='id identifier rubyid_networks'>networks</span> 

<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
  </div>
</div>
    
      <h1>Method: #get_profiles_by_role</h1>
<div class="box_info">
  <dl>
    <dt class="">Defined in:</dt>
    <dd class="">
    lib/hpc/profiles.rb
    </dd>
  </dl>
</div>

<div class="method_details_list">
  <div id="method_details">
    <h3 class="signature first" id="get_profiles_by_role-instance_method">
  
    - (<tt>Object</tt>) <strong>get_profiles_by_role</strong>(role) 
  

  

  
</h3><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


88
89
90
91
92
93
94
95
96
97
98
99</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/hpc/profiles.rb', line 88</span>

<span class='kw'>def</span> <span class='id identifier rubyid_get_profiles_by_role'>get_profiles_by_role</span><span class='lparen'>(</span><span class='id identifier rubyid_role'>role</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_key'>key</span> <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>profiles</span><span class='tstring_end'>&#39;</span></span>
  <span class='comment'># clone the default cope from $options and add the role in parameter
</span>  <span class='id identifier rubyid_scope'>scope</span> <span class='op'>=</span> <span class='gvar'>$options</span><span class='lbracket'>[</span><span class='symbol'>:scope</span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_clone'>clone</span>
  <span class='id identifier rubyid_scope'>scope</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>puppet_role</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='id identifier rubyid_role'>role</span>
  <span class='id identifier rubyid_profiles'>profiles</span> <span class='op'>=</span> <span class='gvar'>$hiera</span><span class='period'>.</span><span class='id identifier rubyid_lookup'>lookup</span><span class='lparen'>(</span><span class='id identifier rubyid_key'>key</span><span class='comma'>,</span>
                           <span class='gvar'>$options</span><span class='lbracket'>[</span><span class='symbol'>:default</span><span class='rbracket'>]</span><span class='comma'>,</span>
                           <span class='id identifier rubyid_scope'>scope</span><span class='comma'>,</span>
                           <span class='kw'>nil</span><span class='comma'>,</span>
                           <span class='gvar'>$options</span><span class='lbracket'>[</span><span class='symbol'>:resolution_type</span><span class='rbracket'>]</span><span class='rparen'>)</span>
  <span class='kw'>return</span> <span class='id identifier rubyid_profiles'>profiles</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
  </div>
</div>
    
      <h1>Method: #get_reverse_zone_name</h1>
<div class="box_info">
  <dl>
    <dt class="">Defined in:</dt>
    <dd class="">
    lib/hpc/dns.rb
    </dd>
  </dl>
</div>

<div class="method_details_list">
  <div id="method_details">
    <h3 class="signature first" id="get_reverse_zone_name-instance_method">
  
    - (<tt>Object</tt>) <strong>get_reverse_zone_name</strong>(ip) 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    <p>Returns the reverse zone name corresponding to an ipaddr. Ex:
   192.168.0.0/16 -&gt; 168.192.in-addr.arpa
   192.168.3.1/24 - 1.168.192.in-addr.arpa</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


202
203
204
205</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/hpc/dns.rb', line 202</span>

<span class='kw'>def</span> <span class='id identifier rubyid_get_reverse_zone_name'>get_reverse_zone_name</span><span class='lparen'>(</span><span class='id identifier rubyid_ip'>ip</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_leading_null'>leading_null</span> <span class='op'>=</span> <span class='lparen'>(</span><span class='int'>32</span> <span class='op'>-</span> <span class='id identifier rubyid_ip'>ip</span><span class='period'>.</span><span class='id identifier rubyid_prefix'>prefix</span><span class='rparen'>)</span> <span class='op'>/</span> <span class='int'>8</span>
  <span class='kw'>return</span> <span class='id identifier rubyid_ip'>ip</span><span class='period'>.</span><span class='id identifier rubyid_reverse'>reverse</span><span class='period'>.</span><span class='id identifier rubyid_split'>split</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>.</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span><span class='lbracket'>[</span><span class='id identifier rubyid_leading_null'>leading_null</span><span class='op'>..</span><span class='op'>-</span><span class='int'>1</span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_join'>join</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>.</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
  </div>
</div>
    
      <h1>Method: #get_reverse_zone_owner</h1>
<div class="box_info">
  <dl>
    <dt class="">Defined in:</dt>
    <dd class="">
    lib/hpc/dns.rb
    </dd>
  </dl>
</div>

<div class="method_details_list">
  <div id="method_details">
    <h3 class="signature first" id="get_reverse_zone_owner-instance_method">
  
    - (<tt>Object</tt>) <strong>get_reverse_zone_owner</strong>(ip, net) 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    <p>Returns the reverse zone entry owner inside the network. Ex:
   ip = 192.168.1.3 and net = 192.168.0.0/16 -&gt; 3.1
   ip = 192.168.1.3 and net = 192.168.1.0/24 -&gt; 3</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


210
211
212
213</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/hpc/dns.rb', line 210</span>

<span class='kw'>def</span> <span class='id identifier rubyid_get_reverse_zone_owner'>get_reverse_zone_owner</span><span class='lparen'>(</span><span class='id identifier rubyid_ip'>ip</span><span class='comma'>,</span> <span class='id identifier rubyid_net'>net</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_trailing_bytes'>trailing_bytes</span> <span class='op'>=</span> <span class='lparen'>(</span><span class='int'>32</span> <span class='op'>-</span> <span class='id identifier rubyid_net'>net</span><span class='period'>.</span><span class='id identifier rubyid_prefix'>prefix</span><span class='rparen'>)</span> <span class='op'>/</span> <span class='int'>8</span>
  <span class='kw'>return</span> <span class='id identifier rubyid_ip'>ip</span><span class='period'>.</span><span class='id identifier rubyid_to_s'>to_s</span><span class='period'>.</span><span class='id identifier rubyid_split'>split</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>.</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_reverse'>reverse</span><span class='lbracket'>[</span><span class='int'>0</span><span class='op'>..</span><span class='id identifier rubyid_trailing_bytes'>trailing_bytes</span><span class='op'>-</span><span class='int'>1</span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_join'>join</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>.</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
  </div>
</div>
    
      <h1>Method: #get_role_by_hostname</h1>
<div class="box_info">
  <dl>
    <dt class="">Defined in:</dt>
    <dd class="">
    lib/hpc/profiles.rb
    </dd>
  </dl>
</div>

<div class="method_details_list">
  <div id="method_details">
    <h3 class="signature first" id="get_role_by_hostname-instance_method">
  
    - (<tt>Object</tt>) <strong>get_role_by_hostname</strong>(hostname) 
  

  

  
</h3><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


65
66
67
68
69
70
71</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/hpc/profiles.rb', line 65</span>

<span class='kw'>def</span> <span class='id identifier rubyid_get_role_by_hostname'>get_role_by_hostname</span><span class='lparen'>(</span><span class='id identifier rubyid_hostname'>hostname</span><span class='rparen'>)</span>
  <span class='kw'>if</span> <span class='id identifier rubyid_hostname'>hostname</span> <span class='op'>=~</span> <span class='tstring'><span class='regexp_beg'>/</span><span class='tstring_content'>^</span><span class='embexpr_beg'>#{</span><span class='gvar'>$CLUSTER_PREFIX</span><span class='embexpr_end'>}</span><span class='tstring_content'>([a-z]+)[0-9]+$</span><span class='regexp_end'>/</span></span>
    <span class='kw'>return</span> <span class='backref'>$1</span>
  <span class='kw'>else</span>
    <span class='kw'>return</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>default</span><span class='tstring_end'>&#39;</span></span>
  <span class='kw'>end</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
  </div>
</div>
    
      <h1>Method: #get_role_index_for_name</h1>
<div class="box_info">
  <dl>
    <dt class="">Defined in:</dt>
    <dd class="">
    lib/facter/role.rb
    </dd>
  </dl>
</div>

<div class="method_details_list">
  <div id="method_details">
    <h3 class="signature first" id="get_role_index_for_name-instance_method">
  
    - (<tt>Object</tt>) <strong>get_role_index_for_name</strong>(hostname, prefix) 
  

  

  
</h3><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


16
17
18
19
20
21
22
23</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/facter/role.rb', line 16</span>

<span class='kw'>def</span> <span class='id identifier rubyid_get_role_index_for_name'>get_role_index_for_name</span><span class='lparen'>(</span><span class='id identifier rubyid_hostname'>hostname</span><span class='comma'>,</span> <span class='id identifier rubyid_prefix'>prefix</span><span class='rparen'>)</span>
  <span class='comment'>#(prefix)(role)XYZ 
</span>  <span class='kw'>if</span> <span class='id identifier rubyid_hostname'>hostname</span> <span class='op'>=~</span> <span class='tstring'><span class='regexp_beg'>/</span><span class='tstring_content'>^</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_prefix'>prefix</span><span class='embexpr_end'>}</span><span class='tstring_content'>([a-z]+[a-z0-9]*[a-z]+)([0-9])+$</span><span class='regexp_end'>/</span></span>
    <span class='kw'>return</span> <span class='lbracket'>[</span><span class='backref'>$1</span><span class='comma'>,</span> <span class='backref'>$2</span><span class='rbracket'>]</span>
  <span class='kw'>else</span>
    <span class='kw'>return</span> <span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>default</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>0</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span>
  <span class='kw'>end</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
  </div>
</div>
    
      <h1>Method: #get_vips</h1>
<div class="box_info">
  <dl>
    <dt class="">Defined in:</dt>
    <dd class="">
    lib/hpc/ha.rb
    </dd>
  </dl>
</div>

<div class="method_details_list">
  <div id="method_details">
    <h3 class="signature first" id="get_vips-instance_method">
  
    - (<tt>Object</tt>) <strong>get_vips</strong> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    <p>Return the vips hash found in hiera</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


53
54
55
56
57
58
59
60
61</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/hpc/ha.rb', line 53</span>

<span class='kw'>def</span> <span class='id identifier rubyid_get_vips'>get_vips</span><span class='lparen'>(</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_key'>key</span> <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>vips</span><span class='tstring_end'>&#39;</span></span>
  <span class='id identifier rubyid_vips'>vips</span> <span class='op'>=</span> <span class='gvar'>$hiera</span><span class='period'>.</span><span class='id identifier rubyid_lookup'>lookup</span><span class='lparen'>(</span><span class='id identifier rubyid_key'>key</span><span class='comma'>,</span>
                       <span class='gvar'>$options</span><span class='lbracket'>[</span><span class='symbol'>:default</span><span class='rbracket'>]</span><span class='comma'>,</span>
                       <span class='gvar'>$options</span><span class='lbracket'>[</span><span class='symbol'>:scope</span><span class='rbracket'>]</span><span class='comma'>,</span>
                       <span class='kw'>nil</span><span class='comma'>,</span>
                       <span class='gvar'>$options</span><span class='lbracket'>[</span><span class='symbol'>:resolution_type</span><span class='rbracket'>]</span><span class='rparen'>)</span>
  <span class='kw'>return</span> <span class='id identifier rubyid_vips'>vips</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
  </div>
</div>
    
      <h1>Method: #hpc_atoh</h1>
<div class="box_info">
  <dl>
    <dt class="">Defined in:</dt>
    <dd class="">
    lib/hpc/hmap.rb<span class="defines">,<br />
      lib/puppet/parser/functions/hpc_atoh.rb</div>
    
    </dd>
  </dl>
</div>

<div class="method_details_list">
  <div id="method_details">
    <h3 class="signature first" id="hpc_atoh-instance_method">
  
    - (<tt>Object</tt>) <strong>hpc_atoh</strong>(array) 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    <p>Returns transform the array into hash with empty values</p>


  </div>
</div>
<div class="tags">
  
<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'></span>
      
      
      
        
        <div class='inline'><p>transform the array into hash with empty values</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


27
28
29
30
31
32
33</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/hpc/hmap.rb', line 27</span>

<span class='kw'>def</span> <span class='id identifier rubyid_hpc_atoh'>hpc_atoh</span><span class='lparen'>(</span><span class='id identifier rubyid_array'>array</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_result'>result</span> <span class='op'>=</span> <span class='const'>Hash</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span><span class='lparen'>(</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_array'>array</span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_value'>value</span><span class='op'>|</span>
    <span class='id identifier rubyid_result'>result</span><span class='lbracket'>[</span><span class='id identifier rubyid_value'>value</span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='const'>Hash</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span><span class='lparen'>(</span><span class='rparen'>)</span>
  <span class='kw'>end</span>
  <span class='kw'>return</span> <span class='id identifier rubyid_result'>result</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
  </div>
</div>
    
      <h1>Method: #hpc_dns_zones</h1>
<div class="box_info">
  <dl>
    <dt class="">Defined in:</dt>
    <dd class="">
    lib/puppet/parser/functions/hpc_dns_zones.rb<span class="defines">,<br />
      lib/hpc/dns.rb</div>
    
    </dd>
  </dl>
</div>

<div class="method_details_list">
  <div id="method_details">
    <h3 class="signature first" id="hpc_dns_zones-instance_method">
  
    - (<tt>Object</tt>) <strong>hpc_dns_zones</strong> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    <p>Returns A hash of DNS zones hashes of the cluster</p>


  </div>
</div>
<div class="tags">
  
<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'></span>
      
      
      
        
        <div class='inline'><p>A hash of DNS zones hashes of the cluster</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/puppet/parser/functions/hpc_dns_zones.rb', line 20</span>

<span class='kw'>def</span> <span class='id identifier rubyid_hpc_dns_zones'>hpc_dns_zones</span><span class='lparen'>(</span><span class='rparen'>)</span>

  <span class='id identifier rubyid_domain'>domain</span> <span class='op'>=</span> <span class='id identifier rubyid_get_domain'>get_domain</span><span class='lparen'>(</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_local_zone'>local_zone</span> <span class='op'>=</span> <span class='const'>DNSZone</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span><span class='lparen'>(</span><span class='id identifier rubyid_domain'>domain</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_reverse_zones'>reverse_zones</span> <span class='op'>=</span> <span class='const'>Array</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span>

  <span class='id identifier rubyid_net_topo'>net_topo</span> <span class='op'>=</span> <span class='id identifier rubyid_get_network_topology'>get_network_topology</span><span class='lparen'>(</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_networks'>networks</span> <span class='op'>=</span> <span class='id identifier rubyid_get_networks_reverse_zones'>get_networks_reverse_zones</span><span class='lparen'>(</span><span class='id identifier rubyid_net_topo'>net_topo</span><span class='rparen'>)</span>

  <span class='comment'># add NS to zone
</span>  <span class='id identifier rubyid_hostname'>hostname</span> <span class='op'>=</span> <span class='const'>Facter</span><span class='period'>.</span><span class='id identifier rubyid_value'>value</span><span class='lparen'>(</span><span class='symbol'>:hostname</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_fqdn'>fqdn</span> <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_hostname'>hostname</span><span class='embexpr_end'>}</span><span class='tstring_content'>.</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_domain'>domain</span><span class='embexpr_end'>}</span><span class='tstring_content'>.</span><span class='tstring_end'>&quot;</span></span>
  <span class='id identifier rubyid_local_zone'>local_zone</span><span class='period'>.</span><span class='id identifier rubyid_add_entry'>add_entry</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>@</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>IN</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>NS</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='id identifier rubyid_fqdn'>fqdn</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_local_zone'>local_zone</span><span class='period'>.</span><span class='id identifier rubyid_add_entry'>add_entry</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>@</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>IN</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>A</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>127.0.0.1</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span>

  <span class='comment'># create a reverse zone for each network
</span>
  <span class='id identifier rubyid_networks'>networks</span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_network'>network</span><span class='op'>|</span>
    <span class='id identifier rubyid_zone_name'>zone_name</span> <span class='op'>=</span> <span class='id identifier rubyid_get_reverse_zone_name'>get_reverse_zone_name</span><span class='lparen'>(</span><span class='id identifier rubyid_network'>network</span><span class='rparen'>)</span>
    <span class='id identifier rubyid_reverse_zone'>reverse_zone</span> <span class='op'>=</span> <span class='const'>DNSZone</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span><span class='lparen'>(</span><span class='id identifier rubyid_zone_name'>zone_name</span><span class='rparen'>)</span>
    <span class='id identifier rubyid_reverse_zone'>reverse_zone</span><span class='period'>.</span><span class='id identifier rubyid_net'>net</span> <span class='op'>=</span> <span class='id identifier rubyid_network'>network</span>
    <span class='id identifier rubyid_reverse_zone'>reverse_zone</span><span class='period'>.</span><span class='id identifier rubyid_add_entry'>add_entry</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>@</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>IN</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>NS</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='id identifier rubyid_fqdn'>fqdn</span><span class='rparen'>)</span>
    <span class='id identifier rubyid_reverse_zones'>reverse_zones</span> <span class='op'>&lt;&lt;</span> <span class='id identifier rubyid_reverse_zone'>reverse_zone</span>
  <span class='kw'>end</span>

  <span class='comment'># add cluster hosts to zones
</span>
  <span class='id identifier rubyid_mn'>mn</span> <span class='op'>=</span> <span class='id identifier rubyid_get_master_network'>get_master_network</span><span class='lparen'>(</span><span class='rparen'>)</span>
  
  <span class='id identifier rubyid_mn'>mn</span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_host'>host</span><span class='comma'>,</span> <span class='id identifier rubyid_details'>details</span><span class='op'>|</span>
    <span class='id identifier rubyid_netifs'>netifs</span> <span class='op'>=</span> <span class='id identifier rubyid_details'>details</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>networks</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span>
    <span class='id identifier rubyid_netifs'>netifs</span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_network'>network</span><span class='comma'>,</span> <span class='id identifier rubyid_params'>params</span><span class='op'>|</span>
      <span class='id identifier rubyid_hostname'>hostname</span> <span class='op'>=</span> <span class='id identifier rubyid_params'>params</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>hostname</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span>
      <span class='id identifier rubyid_ip'>ip</span> <span class='op'>=</span> <span class='const'>IPAddr</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span><span class='lparen'>(</span><span class='id identifier rubyid_params'>params</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>IP</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span><span class='rparen'>)</span>
      <span class='comment'># On the WAN network, take the FQDN of the node instead of its
</span>      <span class='comment'># hostname+domain for the reverse in order to get same response
</span>      <span class='comment'># with DNS servers inside and outside the cluster.
</span>      <span class='kw'>if</span> <span class='id identifier rubyid_network'>network</span> <span class='op'>==</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>wan</span><span class='tstring_end'>&#39;</span></span>
        <span class='id identifier rubyid_fqdn'>fqdn</span> <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_details'>details</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>fqdn</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span><span class='embexpr_end'>}</span><span class='tstring_content'>.</span><span class='tstring_end'>&quot;</span></span>
      <span class='kw'>else</span>
        <span class='id identifier rubyid_fqdn'>fqdn</span> <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_hostname'>hostname</span><span class='embexpr_end'>}</span><span class='tstring_content'>.</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_domain'>domain</span><span class='embexpr_end'>}</span><span class='tstring_content'>.</span><span class='tstring_end'>&quot;</span></span>
      <span class='kw'>end</span>
      <span class='id identifier rubyid_add_entries'>add_entries</span><span class='lparen'>(</span><span class='id identifier rubyid_local_zone'>local_zone</span><span class='comma'>,</span> <span class='id identifier rubyid_reverse_zones'>reverse_zones</span><span class='comma'>,</span> <span class='id identifier rubyid_hostname'>hostname</span><span class='comma'>,</span> <span class='id identifier rubyid_fqdn'>fqdn</span><span class='comma'>,</span> <span class='id identifier rubyid_ip'>ip</span><span class='rparen'>)</span>
    <span class='kw'>end</span>
  <span class='kw'>end</span>

  <span class='comment'># add vips to zones
</span>
  <span class='id identifier rubyid_vips'>vips</span> <span class='op'>=</span> <span class='id identifier rubyid_get_vips'>get_vips</span><span class='lparen'>(</span><span class='rparen'>)</span>

  <span class='id identifier rubyid_vips'>vips</span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_vip'>vip</span><span class='comma'>,</span> <span class='id identifier rubyid_params'>params</span><span class='op'>|</span>
    <span class='id identifier rubyid_hostname'>hostname</span> <span class='op'>=</span> <span class='id identifier rubyid_params'>params</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>hostname</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span>
    <span class='id identifier rubyid_ip'>ip</span> <span class='op'>=</span> <span class='const'>IPAddr</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span><span class='lparen'>(</span><span class='id identifier rubyid_params'>params</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>ip</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span><span class='rparen'>)</span>
    <span class='id identifier rubyid_fqdn'>fqdn</span> <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_hostname'>hostname</span><span class='embexpr_end'>}</span><span class='tstring_content'>.</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_domain'>domain</span><span class='embexpr_end'>}</span><span class='tstring_content'>.</span><span class='tstring_end'>&quot;</span></span>
    <span class='id identifier rubyid_add_entries'>add_entries</span><span class='lparen'>(</span><span class='id identifier rubyid_local_zone'>local_zone</span><span class='comma'>,</span> <span class='id identifier rubyid_reverse_zones'>reverse_zones</span><span class='comma'>,</span> <span class='id identifier rubyid_hostname'>hostname</span><span class='comma'>,</span> <span class='id identifier rubyid_fqdn'>fqdn</span><span class='comma'>,</span> <span class='id identifier rubyid_ip'>ip</span><span class='rparen'>)</span>
  <span class='kw'>end</span>

  <span class='comment'># dump everything into zones big hash
</span>
  <span class='id identifier rubyid_zones'>zones</span> <span class='op'>=</span> <span class='const'>Hash</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span>
  <span class='id identifier rubyid_zones'>zones</span><span class='lbracket'>[</span><span class='id identifier rubyid_local_zone'>local_zone</span><span class='period'>.</span><span class='id identifier rubyid_base'>base</span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='id identifier rubyid_local_zone'>local_zone</span><span class='period'>.</span><span class='id identifier rubyid_dump'>dump</span>
  <span class='id identifier rubyid_reverse_zones'>reverse_zones</span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_reverse_zone'>reverse_zone</span><span class='op'>|</span>
    <span class='id identifier rubyid_zones'>zones</span><span class='lbracket'>[</span><span class='id identifier rubyid_reverse_zone'>reverse_zone</span><span class='period'>.</span><span class='id identifier rubyid_base'>base</span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='id identifier rubyid_reverse_zone'>reverse_zone</span><span class='period'>.</span><span class='id identifier rubyid_dump'>dump</span>
  <span class='kw'>end</span>

  <span class='kw'>return</span> <span class='id identifier rubyid_zones'>zones</span>

<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
  </div>
</div>
    
      <h1>Method: #hpc_ha_vip_notify_scripts</h1>
<div class="box_info">
  <dl>
    <dt class="">Defined in:</dt>
    <dd class="">
    lib/puppet/parser/functions/hpc_ha_vip_notify_scripts.rb<span class="defines">,<br />
      lib/hpc/ha.rb</div>
    
    </dd>
  </dl>
</div>

<div class="method_details_list">
  <div id="method_details">
    <h3 class="signature first" id="hpc_ha_vip_notify_scripts-instance_method">
  
    - (<tt>Object</tt>) <strong>hpc_ha_vip_notify_scripts</strong> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    <p>Returns A hash of VIP notify scripts hash for the current host</p>


  </div>
</div>
<div class="tags">
  
<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'></span>
      
      
      
        
        <div class='inline'><p>A hash of VIP notify scripts hash for the current host</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


20
21
22
23</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/puppet/parser/functions/hpc_ha_vip_notify_scripts.rb', line 20</span>

<span class='kw'>def</span> <span class='id identifier rubyid_hpc_ha_vip_notify_scripts'>hpc_ha_vip_notify_scripts</span><span class='lparen'>(</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_hostname'>hostname</span> <span class='op'>=</span> <span class='const'>Facter</span><span class='period'>.</span><span class='id identifier rubyid_value'>value</span><span class='lparen'>(</span><span class='symbol'>:hostname</span><span class='rparen'>)</span>
  <span class='kw'>return</span> <span class='id identifier rubyid_get_host_vip_notify_scripts'>get_host_vip_notify_scripts</span><span class='lparen'>(</span><span class='id identifier rubyid_hostname'>hostname</span><span class='rparen'>)</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
  </div>
</div>
    
      <h1>Method: #hpc_ha_vips</h1>
<div class="box_info">
  <dl>
    <dt class="">Defined in:</dt>
    <dd class="">
    lib/puppet/parser/functions/hpc_ha_vips.rb<span class="defines">,<br />
      lib/hpc/ha.rb</div>
    
    </dd>
  </dl>
</div>

<div class="method_details_list">
  <div id="method_details">
    <h3 class="signature first" id="hpc_ha_vips-instance_method">
  
    - (<tt>Object</tt>) <strong>hpc_ha_vips</strong> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    <p>Returns A hash of VIP hash for the current host</p>


  </div>
</div>
<div class="tags">
  
<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'></span>
      
      
      
        
        <div class='inline'><p>A hash of VIP hash for the current host</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


20
21
22
23</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/puppet/parser/functions/hpc_ha_vips.rb', line 20</span>

<span class='kw'>def</span> <span class='id identifier rubyid_hpc_ha_vips'>hpc_ha_vips</span><span class='lparen'>(</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_hostname'>hostname</span> <span class='op'>=</span> <span class='const'>Facter</span><span class='period'>.</span><span class='id identifier rubyid_value'>value</span><span class='lparen'>(</span><span class='symbol'>:hostname</span><span class='rparen'>)</span>
  <span class='kw'>return</span> <span class='id identifier rubyid_get_host_vips'>get_host_vips</span><span class='lparen'>(</span><span class='id identifier rubyid_hostname'>hostname</span><span class='rparen'>)</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
  </div>
</div>
    
      <h1>Method: #hpc_ha_vservs</h1>
<div class="box_info">
  <dl>
    <dt class="">Defined in:</dt>
    <dd class="">
    lib/puppet/parser/functions/hpc_ha_vservs.rb<span class="defines">,<br />
      lib/hpc/ha.rb</div>
    
    </dd>
  </dl>
</div>

<div class="method_details_list">
  <div id="method_details">
    <h3 class="signature first" id="hpc_ha_vservs-instance_method">
  
    - (<tt>Object</tt>) <strong>hpc_ha_vservs</strong> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    <p>Returns A list of vserv hash for the current host</p>


  </div>
</div>
<div class="tags">
  
<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'></span>
      
      
      
        
        <div class='inline'><p>A list of vserv hash for the current host</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


20
21
22
23</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/puppet/parser/functions/hpc_ha_vservs.rb', line 20</span>

<span class='kw'>def</span> <span class='id identifier rubyid_hpc_ha_vservs'>hpc_ha_vservs</span><span class='lparen'>(</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_hostname'>hostname</span> <span class='op'>=</span> <span class='const'>Facter</span><span class='period'>.</span><span class='id identifier rubyid_value'>value</span><span class='lparen'>(</span><span class='symbol'>:hostname</span><span class='rparen'>)</span>
  <span class='kw'>return</span> <span class='id identifier rubyid_get_host_vservs'>get_host_vservs</span><span class='lparen'>(</span><span class='id identifier rubyid_hostname'>hostname</span><span class='rparen'>)</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
  </div>
</div>
    
      <h1>Method: #hpc_hmap</h1>
<div class="box_info">
  <dl>
    <dt class="">Defined in:</dt>
    <dd class="">
    lib/hpc/hmap.rb<span class="defines">,<br />
      lib/puppet/parser/functions/hpc_hmap.rb</div>
    
    </dd>
  </dl>
</div>

<div class="method_details_list">
  <div id="method_details">
    <h3 class="signature first" id="hpc_hmap-instance_method">
  
    - (<tt>Object</tt>) <strong>hpc_hmap</strong>(hash, key) 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    <p>Returns Transform a hash of values into a hash of hash</p>


  </div>
</div>
<div class="tags">
  
<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'></span>
      
      
      
        
        <div class='inline'><p>Transform a hash of values into a hash of hash</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


45
46
47
48
49
50
51</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/hpc/hmap.rb', line 45</span>

<span class='kw'>def</span> <span class='id identifier rubyid_hpc_hmap'>hpc_hmap</span><span class='lparen'>(</span><span class='id identifier rubyid_hash'>hash</span><span class='comma'>,</span> <span class='id identifier rubyid_key'>key</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_result'>result</span> <span class='op'>=</span> <span class='const'>Hash</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span><span class='lparen'>(</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_hash'>hash</span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_xkey'>xkey</span><span class='comma'>,</span> <span class='id identifier rubyid_value'>value</span><span class='op'>|</span>
    <span class='id identifier rubyid_result'>result</span><span class='lbracket'>[</span><span class='id identifier rubyid_xkey'>xkey</span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='lbrace'>{</span> <span class='id identifier rubyid_key'>key</span> <span class='op'>=&gt;</span> <span class='id identifier rubyid_value'>value</span> <span class='rbrace'>}</span>
  <span class='kw'>end</span>
  <span class='kw'>return</span> <span class='id identifier rubyid_result'>result</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
  </div>
</div>
    
      <h1>Method: #hpc_nodeset_exec</h1>
<div class="box_info">
  <dl>
    <dt class="">Defined in:</dt>
    <dd class="">
    lib/hpc/nodeset.rb
    </dd>
  </dl>
</div>

<div class="method_details_list">
  <div id="method_details">
    <h3 class="signature first" id="hpc_nodeset_exec-instance_method">
  
    - (<tt>Object</tt>) <strong>hpc_nodeset_exec</strong>(params) 
  

  

  
</h3><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


11
12
13
14
15
16
17
18
19
20
21
22</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/hpc/nodeset.rb', line 11</span>

<span class='kw'>def</span> <span class='id identifier rubyid_hpc_nodeset_exec'>hpc_nodeset_exec</span><span class='lparen'>(</span><span class='id identifier rubyid_params'>params</span><span class='rparen'>)</span>
  <span class='kw'>if</span> <span class='kw'>not</span> <span class='const'>File</span><span class='period'>.</span><span class='id identifier rubyid_executable?'>executable?</span><span class='lparen'>(</span><span class='const'>NODESET_BIN</span><span class='rparen'>)</span>
    <span class='id identifier rubyid_raise'>raise</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Nodeset check_bin failed, </span><span class='embexpr_beg'>#{</span><span class='const'>NODESET_BIN</span><span class='embexpr_end'>}</span><span class='tstring_content'> is not executable.</span><span class='tstring_end'>&quot;</span></span>
  <span class='kw'>end</span>
  <span class='id identifier rubyid_command'>command</span> <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='embexpr_beg'>#{</span><span class='const'>NODESET_BIN</span><span class='embexpr_end'>}</span><span class='tstring_content'> </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_params'>params</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span>
  <span class='id identifier rubyid_out'>out</span><span class='comma'>,</span> <span class='id identifier rubyid_err'>err</span><span class='comma'>,</span> <span class='id identifier rubyid_status'>status</span> <span class='op'>=</span> <span class='const'>Open3</span><span class='period'>.</span><span class='id identifier rubyid_capture3'>capture3</span><span class='lparen'>(</span><span class='id identifier rubyid_command'>command</span><span class='rparen'>)</span>
  <span class='kw'>if</span> <span class='id identifier rubyid_status'>status</span><span class='period'>.</span><span class='id identifier rubyid_exitstatus'>exitstatus</span> <span class='op'>!=</span> <span class='int'>0</span>
    <span class='id identifier rubyid_raise'>raise</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Nodeset call with params(</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_params'>params</span><span class='embexpr_end'>}</span><span class='tstring_content'>) failed with </span><span class='tstring_end'>&quot;</span></span> <span class='op'>+</span>
      <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>status (</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_status'>status</span><span class='period'>.</span><span class='id identifier rubyid_exitstatus'>exitstatus</span><span class='embexpr_end'>}</span><span class='tstring_content'>). Error:\n</span><span class='tstring_end'>&quot;</span></span> <span class='op'>+</span> <span class='id identifier rubyid_err'>err</span>
  <span class='kw'>end</span>
  <span class='kw'>return</span> <span class='id identifier rubyid_out'>out</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
  </div>
</div>
    
      <h1>Method: #hpc_nodeset_expand</h1>
<div class="box_info">
  <dl>
    <dt class="">Defined in:</dt>
    <dd class="">
    lib/hpc/nodeset.rb
    </dd>
  </dl>
</div>

<div class="method_details_list">
  <div id="method_details">
    <h3 class="signature first" id="hpc_nodeset_expand-instance_method">
  
    - (<tt>Object</tt>) <strong>hpc_nodeset_expand</strong>(nodeset) 
  

  

  
</h3><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


36
37
38
39
40
41
42</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/hpc/nodeset.rb', line 36</span>

<span class='kw'>def</span> <span class='id identifier rubyid_hpc_nodeset_expand'>hpc_nodeset_expand</span><span class='lparen'>(</span><span class='id identifier rubyid_nodeset'>nodeset</span><span class='rparen'>)</span>
  <span class='kw'>if</span> <span class='id identifier rubyid_nodeset'>nodeset</span> <span class='op'>==</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_end'>&quot;</span></span>
    <span class='kw'>return</span> <span class='const'>Array</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span><span class='lparen'>(</span><span class='rparen'>)</span>
  <span class='kw'>end</span>
  <span class='id identifier rubyid_output'>output</span> <span class='op'>=</span> <span class='id identifier rubyid_hpc_nodeset_exec'>hpc_nodeset_exec</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>-e </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_nodeset'>nodeset</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span>
  <span class='kw'>return</span> <span class='id identifier rubyid_output'>output</span><span class='period'>.</span><span class='id identifier rubyid_strip'>strip</span><span class='lparen'>(</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_split'>split</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'> </span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
  </div>
</div>
    
      <h1>Method: #hpc_nodeset_fold</h1>
<div class="box_info">
  <dl>
    <dt class="">Defined in:</dt>
    <dd class="">
    lib/hpc/nodeset.rb
    </dd>
  </dl>
</div>

<div class="method_details_list">
  <div id="method_details">
    <h3 class="signature first" id="hpc_nodeset_fold-instance_method">
  
    - (<tt>Object</tt>) <strong>hpc_nodeset_fold</strong>(nodes_array) 
  

  

  
</h3><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


24
25
26
27
28
29
30
31
32
33
34</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/hpc/nodeset.rb', line 24</span>

<span class='kw'>def</span> <span class='id identifier rubyid_hpc_nodeset_fold'>hpc_nodeset_fold</span><span class='lparen'>(</span><span class='id identifier rubyid_nodes_array'>nodes_array</span><span class='rparen'>)</span>
  <span class='kw'>if</span> <span class='kw'>not</span> <span class='id identifier rubyid_nodes_array'>nodes_array</span><span class='period'>.</span><span class='id identifier rubyid_kind_of?'>kind_of?</span><span class='lparen'>(</span><span class='const'>Array</span><span class='rparen'>)</span>
    <span class='id identifier rubyid_raise'>raise</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Parameter nodes_array should be an array.</span><span class='tstring_end'>&quot;</span></span>
  <span class='kw'>end</span>
  <span class='kw'>if</span> <span class='id identifier rubyid_nodes_array'>nodes_array</span><span class='period'>.</span><span class='id identifier rubyid_length'>length</span> <span class='op'>==</span> <span class='int'>0</span>
    <span class='kw'>return</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_end'>&quot;</span></span>
  <span class='kw'>end</span>
  <span class='id identifier rubyid_nodes_list'>nodes_list</span> <span class='op'>=</span> <span class='id identifier rubyid_nodes_array'>nodes_array</span><span class='period'>.</span><span class='id identifier rubyid_join'>join</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'> </span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span>
  <span class='id identifier rubyid_nodeset'>nodeset</span> <span class='op'>=</span> <span class='id identifier rubyid_hpc_nodeset_exec'>hpc_nodeset_exec</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>-f </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_nodes_list'>nodes_list</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span>
  <span class='kw'>return</span> <span class='id identifier rubyid_nodeset'>nodeset</span><span class='period'>.</span><span class='id identifier rubyid_strip'>strip</span><span class='lparen'>(</span><span class='rparen'>)</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
  </div>
</div>
    
      <h1>Method: #hpc_roles_nodeset</h1>
<div class="box_info">
  <dl>
    <dt class="">Defined in:</dt>
    <dd class="">
    lib/puppet/parser/functions/hpc_roles_nodeset.rb<span class="defines">,<br />
      lib/puppet/parser/functions/hpc_roles_nodeset.rb</div>
    
    </dd>
  </dl>
</div>

<div class="method_details_list">
  <div id="method_details">
    <h3 class="signature first" id="hpc_roles_nodeset-instance_method">
  
    - (<tt>Object</tt>) <strong>hpc_roles_nodeset</strong>(roles = nil) 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    <p>Returns A hash with role names as keys and nodeset expression as value</p>


  </div>
</div>
<div class="tags">
  <p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>roles</span>
      
      
        <span class='type'></span>
      
      
        <em class="default">(defaults to: <tt>nil</tt>)</em>
      
      
        &mdash;
        <div class='inline'><p>Array of roles to return, if nil, all roles are returnes</p>
</div>
      
    </li>
  
</ul>

<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'></span>
      
      
      
        
        <div class='inline'><p>A hash with role names as keys and nodeset expression as value</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/puppet/parser/functions/hpc_roles_nodeset.rb', line 26</span>

<span class='kw'>def</span> <span class='id identifier rubyid_hpc_roles_nodeset'>hpc_roles_nodeset</span><span class='lparen'>(</span><span class='id identifier rubyid_roles'>roles</span> <span class='op'>=</span> <span class='kw'>nil</span><span class='rparen'>)</span>
  <span class='comment'># Retrieve facts 
</span>  <span class='id identifier rubyid_hosts_by_role'>hosts_by_role</span> <span class='op'>=</span> <span class='id identifier rubyid_lookupvar'>lookupvar</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>hosts_by_role</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span>

  <span class='kw'>if</span> <span class='kw'>not</span> <span class='id identifier rubyid_roles'>roles</span> 
    <span class='id identifier rubyid_roles'>roles</span> <span class='op'>=</span> <span class='id identifier rubyid_hosts_by_role'>hosts_by_role</span><span class='period'>.</span><span class='id identifier rubyid_keys'>keys</span><span class='lparen'>(</span><span class='rparen'>)</span>
  <span class='kw'>end</span>

  <span class='id identifier rubyid_nodesets'>nodesets</span> <span class='op'>=</span> <span class='const'>Hash</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span><span class='lparen'>(</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_roles'>roles</span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_role'>role</span><span class='op'>|</span>
    <span class='kw'>if</span> <span class='kw'>not</span> <span class='id identifier rubyid_hosts_by_role'>hosts_by_role</span><span class='period'>.</span><span class='id identifier rubyid_has_key?'>has_key?</span><span class='lparen'>(</span><span class='id identifier rubyid_role'>role</span><span class='rparen'>)</span>
      <span class='id identifier rubyid_debug'>debug</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Role </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_role'>role</span><span class='embexpr_end'>}</span><span class='tstring_content'> has no host</span><span class='tstring_end'>&quot;</span></span>
      <span class='kw'>next</span>
    <span class='kw'>end</span>
    <span class='id identifier rubyid_nodeset'>nodeset</span> <span class='op'>=</span> <span class='id identifier rubyid_hpc_nodeset_fold'>hpc_nodeset_fold</span><span class='lparen'>(</span><span class='id identifier rubyid_hosts_by_role'>hosts_by_role</span><span class='lbracket'>[</span><span class='id identifier rubyid_role'>role</span><span class='rbracket'>]</span><span class='rparen'>)</span>
    <span class='id identifier rubyid_nodesets'>nodesets</span><span class='lbracket'>[</span><span class='id identifier rubyid_role'>role</span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='id identifier rubyid_nodeset'>nodeset</span>
  <span class='kw'>end</span>
  
  <span class='kw'>return</span> <span class='id identifier rubyid_nodesets'>nodesets</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
  </div>
</div>
    
      <h1>Method: #hpc_roles_single_nodeset</h1>
<div class="box_info">
  <dl>
    <dt class="">Defined in:</dt>
    <dd class="">
    lib/puppet/parser/functions/hpc_roles_single_nodeset.rb<span class="defines">,<br />
      lib/puppet/parser/functions/hpc_roles_single_nodeset.rb</div>
    
    </dd>
  </dl>
</div>

<div class="method_details_list">
  <div id="method_details">
    <h3 class="signature first" id="hpc_roles_single_nodeset-instance_method">
  
    - (<tt>Object</tt>) <strong>hpc_roles_single_nodeset</strong>(roles = nil) 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    <p>Returns A nodeset expression with all the hosts having selected roles</p>


  </div>
</div>
<div class="tags">
  <p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>roles</span>
      
      
        <span class='type'></span>
      
      
        <em class="default">(defaults to: <tt>nil</tt>)</em>
      
      
        &mdash;
        <div class='inline'><p>A list of roles to select, if nil, all roles are selected</p>
</div>
      
    </li>
  
</ul>

<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'></span>
      
      
      
        
        <div class='inline'><p>A nodeset expression with all the hosts having selected roles</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/puppet/parser/functions/hpc_roles_single_nodeset.rb', line 26</span>

<span class='kw'>def</span> <span class='id identifier rubyid_hpc_roles_single_nodeset'>hpc_roles_single_nodeset</span><span class='lparen'>(</span><span class='id identifier rubyid_roles'>roles</span> <span class='op'>=</span> <span class='kw'>nil</span><span class='rparen'>)</span>
  <span class='comment'># Retrieve facts 
</span>  <span class='id identifier rubyid_hosts_by_role'>hosts_by_role</span> <span class='op'>=</span> <span class='id identifier rubyid_lookupvar'>lookupvar</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>hosts_by_role</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span>

  <span class='kw'>if</span> <span class='kw'>not</span> <span class='id identifier rubyid_roles'>roles</span> 
    <span class='id identifier rubyid_roles'>roles</span> <span class='op'>=</span> <span class='id identifier rubyid_hosts_by_role'>hosts_by_role</span><span class='period'>.</span><span class='id identifier rubyid_keys'>keys</span><span class='lparen'>(</span><span class='rparen'>)</span>
  <span class='kw'>end</span>

  <span class='id identifier rubyid_nodes'>nodes</span> <span class='op'>=</span> <span class='const'>Array</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span><span class='lparen'>(</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_roles'>roles</span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_role'>role</span><span class='op'>|</span>
    <span class='kw'>if</span> <span class='kw'>not</span> <span class='id identifier rubyid_hosts_by_role'>hosts_by_role</span><span class='period'>.</span><span class='id identifier rubyid_has_key?'>has_key?</span><span class='lparen'>(</span><span class='id identifier rubyid_role'>role</span><span class='rparen'>)</span>
      <span class='id identifier rubyid_debug'>debug</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Role </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_role'>role</span><span class='embexpr_end'>}</span><span class='tstring_content'> has no host</span><span class='tstring_end'>&quot;</span></span>
      <span class='kw'>next</span>
    <span class='kw'>end</span>
    <span class='id identifier rubyid_role_nodes'>role_nodes</span> <span class='op'>=</span> <span class='id identifier rubyid_hosts_by_role'>hosts_by_role</span><span class='lbracket'>[</span><span class='id identifier rubyid_role'>role</span><span class='rbracket'>]</span>
    <span class='id identifier rubyid_nodes'>nodes</span> <span class='op'>=</span> <span class='id identifier rubyid_nodes'>nodes</span> <span class='op'>+</span> <span class='id identifier rubyid_role_nodes'>role_nodes</span>
  <span class='kw'>end</span>
  
  <span class='kw'>return</span> <span class='id identifier rubyid_hpc_nodeset_fold'>hpc_nodeset_fold</span><span class='lparen'>(</span><span class='id identifier rubyid_nodes'>nodes</span><span class='rparen'>)</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
  </div>
</div>
    
      <h1>Method: #hpc_shorewall_interfaces</h1>
<div class="box_info">
  <dl>
    <dt class="">Defined in:</dt>
    <dd class="">
    lib/puppet/parser/functions/hpc_shorewall_interfaces.rb<span class="defines">,<br />
      lib/puppet/parser/functions/hpc_shorewall_interfaces.rb</div>
    
    </dd>
  </dl>
</div>

<div class="method_details_list">
  <div id="method_details">
    <h3 class="signature first" id="hpc_shorewall_interfaces-instance_method">
  
    - (<tt>Object</tt>) <strong>hpc_shorewall_interfaces</strong> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    <p>Returns A hash with interfaces has key and a hash <code>{ &#39;zone&#39; =&gt; &#39;&lt;firewall_zone&#39;}</code> as value</p>


  </div>
</div>
<div class="tags">
  
<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'></span>
      
      
      
        
        <div class='inline'><p>A hash with interfaces has key and a hash <code>{ &#39;zone&#39; =&gt; &#39;&lt;firewall_zone&#39;}</code> as value</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/puppet/parser/functions/hpc_shorewall_interfaces.rb', line 25</span>

<span class='kw'>def</span> <span class='id identifier rubyid_hpc_shorewall_interfaces'>hpc_shorewall_interfaces</span><span class='lparen'>(</span><span class='rparen'>)</span>
  <span class='comment'># Retrieve facts
</span>  <span class='comment'>#  HPC cluster networks
</span>  <span class='id identifier rubyid_topo'>topo</span> <span class='op'>=</span> <span class='id identifier rubyid_function_hiera'>function_hiera</span><span class='lparen'>(</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>net_topology</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span><span class='rparen'>)</span>
  <span class='comment'>#  Networks connected to this host
</span>  <span class='id identifier rubyid_mytopo'>mytopo</span> <span class='op'>=</span> <span class='id identifier rubyid_lookupvar'>lookupvar</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>mynet_topology</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span>

  <span class='id identifier rubyid_interfaces'>interfaces</span> <span class='op'>=</span> <span class='const'>Hash</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span><span class='lparen'>(</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_mytopo'>mytopo</span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_net_name'>net_name</span><span class='comma'>,</span> <span class='id identifier rubyid_mynet'>mynet</span><span class='op'>|</span>
    <span class='kw'>if</span> <span class='kw'>not</span> <span class='id identifier rubyid_topo'>topo</span><span class='lbracket'>[</span><span class='id identifier rubyid_net_name'>net_name</span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_has_key?'>has_key?</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>firewall_zone</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span>
      <span class='kw'>next</span>
    <span class='kw'>end</span>
    <span class='id identifier rubyid_mynet'>mynet</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>interfaces</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_interface_name'>interface_name</span><span class='op'>|</span>
      <span class='id identifier rubyid_interface'>interface</span> <span class='op'>=</span> <span class='const'>Hash</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span><span class='lparen'>(</span><span class='rparen'>)</span>
      <span class='id identifier rubyid_interface'>interface</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>zone</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span> <span class='op'>=</span>  <span class='id identifier rubyid_topo'>topo</span><span class='lbracket'>[</span><span class='id identifier rubyid_net_name'>net_name</span><span class='rbracket'>]</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>firewall_zone</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span>
      <span class='id identifier rubyid_interfaces'>interfaces</span><span class='lbracket'>[</span><span class='id identifier rubyid_interface_name'>interface_name</span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='id identifier rubyid_interface'>interface</span>
    <span class='kw'>end</span>
  <span class='kw'>end</span>
  
  <span class='kw'>return</span> <span class='id identifier rubyid_interfaces'>interfaces</span>

<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
  </div>
</div>
    
      <h1>Method: #hpc_source_file</h1>
<div class="box_info">
  <dl>
    <dt class="">Defined in:</dt>
    <dd class="">
    lib/hpc/source.rb
    </dd>
  </dl>
</div>

<div class="method_details_list">
  <div id="method_details">
    <h3 class="signature first" id="hpc_source_file-instance_method">
  
    - (<tt>Object</tt>) <strong>hpc_source_file</strong>(source) 
  

  

  
</h3><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/hpc/source.rb', line 3</span>

<span class='kw'>def</span> <span class='id identifier rubyid_hpc_source_file'>hpc_source_file</span><span class='lparen'>(</span><span class='id identifier rubyid_source'>source</span><span class='rparen'>)</span>

  <span class='kw'>if</span> <span class='id identifier rubyid_source'>source</span><span class='period'>.</span><span class='id identifier rubyid_kind_of?'>kind_of?</span><span class='lparen'>(</span><span class='const'>Array</span><span class='rparen'>)</span>
    <span class='id identifier rubyid_source_array'>source_array</span> <span class='op'>=</span> <span class='id identifier rubyid_source'>source</span>
  <span class='kw'>else</span>
    <span class='id identifier rubyid_source_array'>source_array</span> <span class='op'>=</span> <span class='lbracket'>[</span><span class='id identifier rubyid_source'>source</span><span class='rbracket'>]</span>
  <span class='kw'>end</span>

  <span class='comment'># First, try to read the file with the puppet function 
</span>  <span class='comment'># file, it handles fallback natively and paths like:
</span>  <span class='comment'># * &lt;module&gt;/&lt;filename&gt;
</span>  <span class='comment'># * Absolute file name
</span>  <span class='id identifier rubyid_data'>data</span> <span class='op'>=</span> <span class='kw'>nil</span>
  <span class='kw'>begin</span>
    <span class='id identifier rubyid_data'>data</span> <span class='op'>=</span> <span class='id identifier rubyid_function_file'>function_file</span><span class='lparen'>(</span><span class='id identifier rubyid_source_array'>source_array</span><span class='rparen'>)</span>
  <span class='kw'>rescue</span>
    <span class='id identifier rubyid_debug'>debug</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>function_file failed to read </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_source_array'>source_array</span><span class='embexpr_end'>}</span><span class='tstring_content'>.</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span>
  <span class='kw'>end</span>

  <span class='kw'>if</span> <span class='kw'>not</span> <span class='id identifier rubyid_data'>data</span>
    <span class='id identifier rubyid_source_array'>source_array</span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_current_file'>current_file</span><span class='op'>|</span>
      <span class='kw'>begin</span>
        <span class='comment'># Remove the &#39;file://&#39; part
</span>        <span class='id identifier rubyid_uri'>uri</span> <span class='op'>=</span> <span class='id identifier rubyid_current_file'>current_file</span><span class='period'>.</span><span class='id identifier rubyid_sub'>sub</span><span class='lparen'>(</span><span class='tstring'><span class='regexp_beg'>%r{</span><span class='tstring_content'>^file://</span><span class='regexp_end'>}</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span>
        <span class='id identifier rubyid_data'>data</span> <span class='op'>=</span> <span class='id identifier rubyid_open'>open</span><span class='lparen'>(</span><span class='id identifier rubyid_uri'>uri</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>rb</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span> <span class='lbrace'>{</span> <span class='op'>|</span><span class='id identifier rubyid_f'>f</span><span class='op'>|</span> <span class='id identifier rubyid_f'>f</span><span class='period'>.</span><span class='id identifier rubyid_read'>read</span> <span class='rbrace'>}</span>
      <span class='kw'>rescue</span> <span class='op'>=&gt;</span> <span class='id identifier rubyid_e'>e</span> 
          <span class='id identifier rubyid_debug'>debug</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>IO module failed to read </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_current_file'>current_file</span><span class='embexpr_end'>}</span><span class='tstring_content'>: </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_e'>e</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span>
      <span class='kw'>end</span>
    <span class='kw'>end</span>
  <span class='kw'>end</span>

  <span class='kw'>if</span> <span class='kw'>not</span> <span class='id identifier rubyid_data'>data</span>
    <span class='id identifier rubyid_raise'>raise</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Failed to get data for sources: </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_source'>source</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span>
  <span class='kw'>end</span>

  <span class='kw'>return</span> <span class='id identifier rubyid_data'>data</span>

<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
  </div>
</div>
    
      <h1>Method: #roles</h1>
<div class="box_info">
  <dl>
    <dt class="">Defined in:</dt>
    <dd class="">
    lib/hpc/profiles.rb
    </dd>
  </dl>
</div>

<div class="method_details_list">
  <div id="method_details">
    <h3 class="signature first" id="roles-instance_method">
  
    - (<tt>Object</tt>) <strong>roles</strong> 
  

  

  
</h3><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


73
74
75
76
77
78
79
80
81
82
83
84
85
86</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/hpc/profiles.rb', line 73</span>

<span class='kw'>def</span> <span class='id identifier rubyid_roles'>roles</span><span class='lparen'>(</span><span class='rparen'>)</span>
  <span class='comment'># FIXME: ruby functions should not depend on facts
</span>  <span class='id identifier rubyid_hostlist'>hostlist</span> <span class='op'>=</span> <span class='const'>Facter</span><span class='period'>.</span><span class='id identifier rubyid_value'>value</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>hostfile</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span>
  <span class='id identifier rubyid_roles'>roles</span> <span class='op'>=</span> <span class='const'>Array</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span>
  <span class='id identifier rubyid_hostlist'>hostlist</span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_host'>host</span><span class='op'>|</span>
    <span class='id identifier rubyid_hostname'>hostname</span> <span class='op'>=</span> <span class='id identifier rubyid_host'>host</span><span class='lbracket'>[</span><span class='int'>0</span><span class='rbracket'>]</span>
    <span class='id identifier rubyid_role'>role</span> <span class='op'>=</span> <span class='id identifier rubyid_get_role_by_hostname'>get_role_by_hostname</span><span class='lparen'>(</span><span class='id identifier rubyid_hostname'>hostname</span><span class='rparen'>)</span>
    <span class='comment'># ignore the default role
</span>    <span class='kw'>if</span> <span class='id identifier rubyid_role'>role</span> <span class='op'>!=</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>default</span><span class='tstring_end'>&#39;</span></span>
      <span class='id identifier rubyid_roles'>roles</span><span class='period'>.</span><span class='id identifier rubyid_push'>push</span><span class='lparen'>(</span><span class='id identifier rubyid_role'>role</span><span class='rparen'>)</span> <span class='kw'>unless</span> <span class='id identifier rubyid_roles'>roles</span><span class='period'>.</span><span class='id identifier rubyid_include?'>include?</span><span class='lparen'>(</span><span class='id identifier rubyid_role'>role</span><span class='rparen'>)</span>
    <span class='kw'>end</span>
  <span class='kw'>end</span>
  <span class='kw'>return</span> <span class='id identifier rubyid_roles'>roles</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
  </div>
</div>
    
  </div>

</div>

    <div id="footer">
  Generated on Thu Dec 15 18:56:31 2016 by
  <a href="http://yardoc.org" title="Yay! A Ruby Documentation Tool" target="_parent">yard</a>
  0.8.7.4 (ruby-2.1.5).
</div>

  </body>
</html>