<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
<title>
  File: README
  
    &mdash; Documentation by YARD 0.8.7.4
  
</title>

  <link rel="stylesheet" href="css/style.css" type="text/css" charset="utf-8" />

  <link rel="stylesheet" href="css/common.css" type="text/css" charset="utf-8" />

<script type="text/javascript" charset="utf-8">
  hasFrames = window.top.frames.main ? true : false;
  relpath = '';
  framesUrl = "frames.html#!file.README.html";
</script>


  <script type="text/javascript" charset="utf-8" src="js/jquery.js"></script>

  <script type="text/javascript" charset="utf-8" src="js/app.js"></script>


  </head>
  <body>
    <div id="header">
      <div id="menu">
  
    <a href="_index.html">Index</a> &raquo; 
    <span class="title">File: README</span>
  

  <div class="noframes"><span class="title">(</span><a href="." target="_top">no frames</a><span class="title">)</span></div>
</div>

      <div id="search">
  
    <a class="full_list_link" id="puppet_manifest_list_link"
        href="puppet_manifest_list.html">
      Puppet Manifest List
    </a>
  
    <a class="full_list_link" id="puppet_plugin_list_link"
        href="puppet_plugin_list.html">
      Puppet Plugin List
    </a>
  
    <a class="full_list_link" id="puppet_type_list_link"
        href="puppet_type_list.html">
      Puppet Type List
    </a>
  
    <a class="full_list_link" id="puppet_provider_list_link"
        href="puppet_provider_list.html">
      Puppet Provider List
    </a>
  
    <a class="full_list_link" id="class_list_link"
        href="class_list.html">
      Class List
    </a>
  
    <a class="full_list_link" id="method_list_link"
        href="method_list.html">
      Method List
    </a>
  
    <a class="full_list_link" id="file_list_link"
        href="file_list.html">
      File List
    </a>
  
</div>
      <div class="clear"></div>
    </div>

    <iframe id="search_frame"></iframe>

    <div id="content"><div id='filecontents'><h1>network</h1>

<h4>Table of Contents</h4>

<ol>
<li><a href="#overview">Overview</a></li>
<li><a href="#module-description">Module Description</a></li>
<li><a href="#setup">Setup</a>

<ul>
<li><a href="#what-network-affects">What dns affects</a></li>
<li><a href="#setup-requirements">Setup requirements</a></li>
<li><a href="#beginning-with-network">Beginning with dns</a></li>
</ul></li>
<li><a href="#usage">Usage</a></li>
<li><a href="#limitations">Limitations</a></li>
<li><a href="#development">Development</a></li>
</ol>

<h2>Module Description</h2>

<p>Configures the network on this system</p>

<p>Configures the network interfaces on this system. This module configures:</p>

<ul>
<li>Hostname</li>
<li>Routing (default gateway and static routes)</li>
<li>Ethernet interfaces</li>
<li>Ethernet bonding</li>
<li>Bridges</li>
<li>Intel Omni-Path</li>
<li>Mellanox Infiniband</li>
</ul>

<p>Note: Intel Omni-Path and Mellanox Infiniband are mutually exclusive.</p>

<p>The network module uses an interface list provided by the <code>netconfig</code> fact
from the <code>hpclib</code> module. This fact uses data from the hiera
<code>master_network</code> to generate the interface list. It also uses data from the
<code>net_topology</code> fact to get generic parameters for networks. </p>

<p>On Debian, the module configures all interfaces as manual, it relies on a
special service it sets up (<code>ifup-hotplug</code>) to bring the interfaces up during
boot or after changing the configuration.</p>

<h2>Setup</h2>

<h3>What network affects</h3>

<p>On Debian, this module takes over <code>/etc/network/interfaces</code> configuration file.</p>

<h3>Setup Requirements</h3>

<p>This module uses hpclib, it particularly uses the <code>netconfig</code> fact to get the
interface list.</p>

<h3>Beginning with network</h3>

<p>Basic usage is:</p>

<pre class="code ruby"><code class="ruby">class{&#39;::network&#39;:
  defaultgw  =&gt; &#39;10.1.0.1&#39;,
  fqdn       =&gt; &#39;clnode01.cluster.hpc.example.com&#39;,
  ib_enable  =&gt; false,
  opa_enable =&gt; false,
}
</code></pre>

<p>The parameters <code>ib_enable</code> and <code>opa_enable</code> can be ommited. When they are
true, they configure Mellanox Infiniband and Intel Omni-Path respectively.</p>

<h2>Usage</h2>

<h3>Bonding</h3>

<p>Bonding is configured by passing bonding options as a hash:</p>

<pre class="code ruby"><code class="ruby">class{&#39;::network&#39;:
  bonding_options =&gt; {
    &#39;bond0&#39; =&gt; {
      &#39;slaves&#39;  =&gt; [ &#39;eth0&#39;, &#39;eth1&#39; ],
      &#39;options&#39; =&gt; &#39;mode=active-backup primary=eth0&#39;,
    },
    &#39;bond1&#39; =&gt; {
      &#39;slaves&#39;  =&gt; [ &#39;eth2&#39;, &#39;eth3&#39; ],
      &#39;options&#39; =&gt; &#39;mode=active-backup primary=eth2&#39;,
    },
  },
}
</code></pre>

<h3>Bridges</h3>

<p>Bridges are configured by passing bridge options as a hash. If the
bridged port does not exists in the netconfig fact, it will be added
automatically when the configuration is written.</p>

<pre class="code ruby"><code class="ruby">class{&#39;::network&#39;:
  bridge_options =&gt; {
    &#39;br0&#39; =&gt; {
      &#39;ports&#39; =&gt; [&#39;eth0&#39;],
      &#39;description&#39; =&gt; &#39;administraton network on service and nas nodes&#39;,
    },
    &#39;br2&#39;:
      &#39;ports&#39; =&gt; [&#39;bond2&#39;],
      &#39;description&#39; =&gt; &#39;WAN network on service nodes&#39;,
    },
  },
}
</code></pre>

<h3>Intel Omni-Path</h3>

<p>When enabled, Intel Omni-Path will install the relevant packages and load the
modules. Interface configuration (<code>ib0</code>) is done like any other interface.</p>

<p>Intel Omni-Path does not configures the <code>rdma</code> service but directly
configures <code>irqbalance</code> and systemd modules load.</p>

<pre class="code ruby"><code class="ruby">class{&#39;::network&#39;:
  defaultgw  =&gt; &#39;10.1.0.1&#39;,
  fqdn       =&gt; &#39;clnode01.cluster.hpc.example.com&#39;,
  ib_enable  =&gt; false,
  opa_enable =&gt; true,
}
</code></pre>

<h3>Mellanox Infiniband</h3>

<p>When enabled, Mellanox Infiniband will install the relevant packages and load
the modules. Interface configuration (<code>ib0</code>) is done like any other
interface.</p>

<p>Mellanox Infiniband configures the <code>openib</code> service.</p>

<pre class="code ruby"><code class="ruby">class{&#39;::network&#39;:
  defaultgw  =&gt; &#39;10.1.0.1&#39;,
  fqdn       =&gt; &#39;clnode01.cluster.hpc.example.com&#39;,
  ib_enable  =&gt; true,
  opa_enable =&gt; false,
}
</code></pre>

<h3>IPoIB</h3>

<p>The IPoIB settings are shared between Mellanox Infiniband and Intel Omni-Path:</p>

<pre class="code ruby"><code class="ruby">class{&#39;::network&#39;:
  defaultgw  =&gt; &#39;10.1.0.1&#39;,
  fqdn       =&gt; &#39;clnode01.cluster.hpc.example.com&#39;,
  ib_enable  =&gt; true,
  opa_enable =&gt; false,
  ib_mode    =&gt; &#39;datagram&#39;,
  ib_mtu     =&gt; &#39;4096&#39;,
}
</code></pre>

<h2>Limitations</h2>

<p>This module is tested on Debian.</p>

<h2>Development</h2>

<p>Patches and issues can be submitted on github:
<a href="https://github.com/edf-hpc/puppet-hpc">https://github.com/edf-hpc/puppet-hpc</a></p>
</div></div>

    <div id="footer">
  Generated on Tue Jan  3 10:45:52 2017 by
  <a href="http://yardoc.org" title="Yay! A Ruby Documentation Tool" target="_parent">yard</a>
  0.8.7.4 (ruby-2.1.5).
</div>

  </body>
</html>