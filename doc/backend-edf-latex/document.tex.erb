<%#encoding:UTF-8%>
\documentclass[10pt,a4paper]{report}
\usepackage[T1]{fontenc}
\usepackage[utf8]{inputenc}
\usepackage{lmodern} % font
\usepackage{graphicx} % pictures
\usepackage{float}
\usepackage{longtable} % for long tables
\usepackage{array} 
\newcolumntype{M}[1]{>{\raggedright}m{#1}}
\usepackage{multirow} % col/row span in tables
\usepackage{listings} % source code with syntax high lighting
\usepackage{color} % to define own set of colours
\usepackage{textcomp} % More symbols

\usepackage{url} % url proper formatting
\usepackage{lastpage} % count total number of pages
\usepackage{lmodern} % font package
\renewcommand{\rmdefault}{lmss} % change font familly to sans-serif
%\renewcommand{\rmdefault}{cmbr}

%\usepackage{fullpage} % significantly reduce margins
\usepackage[top=2cm, bottom=2.5cm, outer=2cm, inner=3.5cm, headsep=10pt]{geometry}

% remove spacing between items in lists
\usepackage{enumitem}
%\setlist{nosep} % or
\setlist{noitemsep,leftmargin=15pt,topsep=5pt} %to leave space around whole list
% reduce left margins of lists from original 26pt
%\setlist[itemize]{leftmargin=15pt}
%\setlist[enumerate]{leftmargin=15pt}

% define handful set of colors
\definecolor{grey}{rgb}{0.4,0.4,0.4}
\definecolor{trust}{rgb}{0.71,0.14,0.07}
\definecolor{edf-blue}{rgb}{0.0,0.36,0.73}
\definecolor{mygreen}{rgb}{0,0.6,0}
\definecolor{mygray}{rgb}{0.5,0.5,0.5}
\definecolor{mymauve}{rgb}{0.58,0,0.82}

\usepackage[pdftex, colorlinks=true, linkcolor=grey, citecolor=grey, urlcolor=blue]{hyperref}
\usepackage{pdfpages} % to include external pdf files
\usepackage[titles]{tocloft} % for spaces in tableofcontents
\usepackage{chngpage} % for titlepage

% configuration of tableofcontents
\setlength{\cftbeforesecskip}{0.5ex}                  % reduce spaces between section lines
\renewcommand{\cftsecleader}{\cftdotfill{\cftdotsep}} % add dots even for section lines
\lstset{  
  basicstyle=\small\ttfamily,
  columns=fullflexible,
  keepspaces=true,
  backgroundcolor=\color{white},   % choose the background color
  breaklines=true,                 % automatic line breaking only at whitespace
  captionpos=b,                    % sets the caption-position to bottom
  commentstyle=\color{mygreen},      % comment style
  escapeinside={\%*}{*)},          % if you want to add LaTeX within your code
  keywordstyle=\color{blue},       % keyword style
  stringstyle=\color{mymauve},       % string literal style
  mathescape=false,                 % Don't treat $ as special characters
}
\usepackage{fancyhdr}
\pagestyle{fancy}

\renewcommand{\headrulewidth}{0.4pt}
\fancyhead[RO,LE]{\leftmark}
\fancyhead[C]{} 
\fancyhead[LO,RE]{\includegraphics[width=10mm]{backend-edf-latex/logo_edf}}

\renewcommand{\footrulewidth}{0.4pt}
\fancyfoot[RO,LE]{\thepage}
\fancyfoot[C]{} 
\fancyfoot[LO,RE]{<%= @header.title %>}

\begin{document}

\begin{titlepage}
\changepage{20mm}{0mm}{0mm}{0mm}{0mm}{0mm}{0mm}{0mm}{0mm}
%\setlength{\textheight}{28cm}
~\\
% textwidth = 210 - 60 = 150mm
\setlength{\tabcolsep}{0mm} % default is 2.12mm

\begin{tabular}{ l r }
  \parbox{110mm}{
    \textcolor{edf-blue}{
    {\large Direction des Services Partagés} \\
    {\large CSP Informatique \& Télécommunications} \\
    Branche Exploitation SI et Services d'Infrastructures - ESI\textsuperscript{2}
    }
   } & \includegraphics[width=25mm]{backend-edf-latex/logo_edf}
  \tabularnewline
\end{tabular}
\\[5cm]
\begin{tabular*}{\textwidth}{@{\extracolsep{\fill}} |l|r|}
%\begin{tabular}{\textwidth}{ |l|r| }
  \hline
  \multicolumn{2}{|p{\textwidth}|} { \rule[-2.5cm]{0cm}{1cm}} \\
  \multicolumn{2}{|p{\textwidth}|} { \center \textcolor{edf-blue}{\bf{\Huge <%= @header.title %>}} \rule[-2.5cm]{0cm}{2cm}} \\
  %\multicolumn{2}{|p{\textwidth}|} { \center \textcolor{edf-blue}{\bf{\Huge <%= @header.title %>}} } \\
  \multicolumn{1}{|l}{Date: \date{} } & Pages: \pageref{LastPage} \\
  \hline
\end{tabular*}
\setlength{\tabcolsep}{2.12mm} % restore default is 2.12mm
\\[3cm]
% 150 - (8 * 2.12) = 133mm / 3 = 44mm
\center \large Authors: <%= attr :author %><%
          if attr? :email %>
<<%= sub_macros(attr :email) %>><%
          end %>
\\[2cm]
\centering \includegraphics[width=100mm]{backend-edf-latex/logo_ccn_hpc}
\vfill

\end{titlepage}

\tableofcontents

<%= content %>

<% unless !footnotes? || attr?(:nofootnotes) %>
<%
  footnotes.each do |fn| %>
<%= fn.index %>
<%= fn.text %><%
  end 
end %>

<%
if attr? :revnumber %>
<%= %(#{attr 'version-label'} #{attr :revnumber}) %><%
end
if attr? 'last-update-label' %>
<%= %(#{attr 'last-update-label'} #{attr :docdatetime}) %><%
end %><%= (docinfo_content = (docinfo :footer)).empty? ? nil : %(
#{docinfo_content}) %>

\end{document}
