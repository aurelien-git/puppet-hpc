<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>
  Hostclass: profiles::auth::client
  
    &mdash; Documentation by YARD 0.8.7.4
  
</title>

  <link rel="stylesheet" href="../../css/style.css" type="text/css" charset="utf-8" />

  <link rel="stylesheet" href="../../css/common.css" type="text/css" charset="utf-8" />

<script type="text/javascript" charset="utf-8">
  hasFrames = window.top.frames.main ? true : false;
  relpath = '../../';
  framesUrl = "../../frames.html#!profiles/auth/client.html";
</script>


  <script type="text/javascript" charset="utf-8" src="../../js/jquery.js"></script>

  <script type="text/javascript" charset="utf-8" src="../../js/app.js"></script>


  </head>
  <body>
    <div id="header">
      <div id="menu">
  
    <a href="../../_index.html">Index (c)</a> &raquo;
    <span class='title'>profiles</span> &raquo; <span class='title'>auth</span>
     &raquo; 
    <span class="title">client</span>
  

  <div class="noframes"><span class="title">(</span><a href="." target="_top">no frames</a><span class="title">)</span></div>
</div>

      <div id="search">
  
    <a class="full_list_link" id="puppet_manifest_list_link"
        href="../../puppet_manifest_list.html">
      Puppet Manifest List
    </a>
  
    <a class="full_list_link" id="puppet_plugin_list_link"
        href="../../puppet_plugin_list.html">
      Puppet Plugin List
    </a>
  
    <a class="full_list_link" id="puppet_type_list_link"
        href="../../puppet_type_list.html">
      Puppet Type List
    </a>
  
    <a class="full_list_link" id="puppet_provider_list_link"
        href="../../puppet_provider_list.html">
      Puppet Provider List
    </a>
  
    <a class="full_list_link" id="class_list_link"
        href="../../class_list.html">
      Class List
    </a>
  
    <a class="full_list_link" id="method_list_link"
        href="../../method_list.html">
      Method List
    </a>
  
    <a class="full_list_link" id="file_list_link"
        href="../../file_list.html">
      File List
    </a>
  
</div>
      <div class="clear"></div>
    </div>

    <iframe id="search_frame"></iframe>

    <div id="content"><div class='module_header'>
  <h1>
    Puppet Class: client
  </h1>
</div>

<dl class="box">
  
  
    <dt class="r1 last">Defined in:</dt>
    <dd class="r1 last">manifests/auth/client.pp</dd>
  
</dl>
<div class="clear"></div>

<h2>Overview</h2><div class="docstring">
  <div class="discussion">
    <p><p>Authentication system client</p>

<p>Authentication uses the SSS daemon to configure node directory and
authentication. The profile can configure SSSD to authenticate against either
an internal LDAP replica or an external reference LDAP server. The optional
Kerberos configuration necessarily connect to an external server.</p>

<h2>SSSD</h2>

<p>SSSD is configured with four hiera keys
(<code>profiles::auth::client::sssd_options_*</code>), those options are combined
to create <code>sssd_options</code> used to generate the file <code>/etc/sssd/sssd.conf</code></p>

<p>The URI to the LDAP server depends on the value of the boolean <code>external_ldap</code>
parameter. If true, the URI is the value of <code>ldap_external_uri</code>, otherwise
(default) it is <code>ldap_internal_uri</code>.</p>

<h2>Kerberos</h2>

<p>If the <code>enable_kerberos</code> hiera boolean is true, the options related to
kerberos are also generated.</p>

<h2>Example</h2>

<p>The example below relies on some other hiera variables like
<code>profiles::auth::ldap_default_authtok</code> that should define the password.</p>

<p><code>certificates::certificates_directory</code> is defined with the keys for the
replica configuration.</p>

<p>If you have a trusted certificate, you should pay attention to the
<code>ldap_tls_reqcert</code> value that should use <code>require</code> in production.</p>

<pre class="code ruby"><code class="ruby">profiles::auth::client::enable_kerberos: false
kdc_primary:                    &#39;kdc1.example.com&#39;
kdc_secondary:                  &#39;kdc2.example.com&#39;
ldap_external:                  &#39;ldap.example.com
krb5_realm:                     &#39;EXAMPLE.COM&#39;

profiles::auth::client::external_ldap: false
profiles::auth::client::sssd_options_general:
  config_file_version:  &#39;2&#39;
  reconnection_retries: &#39;3&#39;
  sbus_timeout:         &#39;30&#39;
  services:             &#39;nss,pam&#39;
  domains:              &quot;%{hiera(&#39;cluster_name&#39;)}&quot;
profiles::auth::client::sssd_options_nss:
  filter_groups:        &#39;root&#39;
  filter_users:         &#39;root&#39;
  reconnection_retries: &#39;3&#39;
profiles::auth::client::sssd_options_pam:
  reconnection_retries:           &#39;3&#39;
  offline_credentials_expiration: &#39;1&#39;
profiles::auth::client::ldap_external_uri: &quot;ldaps://%{hiera(&#39;ldap_external_primary&#39;)}, ldaps://%{hiera(&#39;ldap_external_secondary&#39;)}&quot;
profiles::auth::client::ldap_internal_uri: &quot;ldaps://%{hiera(&#39;ldap_internal_primary&#39;)}, ldaps://%{hiera(&#39;ldap_internal_secondary&#39;)}&quot;
profiles::auth::client::sssd_options_domain:
  name:                      &quot;%{hiera(&#39;cluster_name&#39;)}&quot;
  description:               &quot;LDAP replica for %{hiera(&#39;cluster_name&#39;)}&quot;
  id_provider:               &#39;ldap&#39;
  auth_provider:             &#39;krb5&#39;
  cache_credentials:         &#39;true&#39;
  enumerate:                 &#39;true&#39;
  min_id:                    &#39;1000&#39;
  ldap_tls_reqcert:          &#39;allow&#39;
  ldap_tls_cacert:           &quot;%{hiera(&#39;certificates::certificates_directory&#39;)}&quot;
  ldap_search_timeout:       &#39;3&#39;
  ldap_network_timeout:      &#39;2&#39;
  ldap_pwd_policy:           &#39;&#39;
  case_sensitive:            &quot;%{hiera(&#39;sssd::case_sensitive&#39;)}&quot;
  account_cache_expiration:  &#39;1&#39;
  ldap_user_gecos:           &#39;cn&#39;
  ldap_schema:               &#39;rfc2307bis&#39;
  ldap_search_base:          &#39;dc=example,dc=com&#39;
  ldap_default_bind_dn:      &#39;cn=nss,ou=infra,dc=example,dc=com&#39;
  ldap_default_authtok_type: &#39;password&#39;
  ldap_default_authtok:      &quot;%{hiera(&#39;profiles::auth::ldap_default_authtok&#39;)}&quot;
  ldap_user_search_base:     &#39;ou=people,dc=example,dc=com&#39;
  ldap_group_search_base:    &#39;ou=groups,dc=example,dc=com&#39;
profiles::auth::client::krb5_server:                    &quot;%{hiera(&#39;kdc_primary&#39;)}, %{hiera(&#39;kdc_secondary&#39;)}&quot;
profiles::auth::client::krb5_realm:                     &quot;%{hiera(&#39;krb5_realm&#39;)}&quot;
profiles::auth::client::krb5_store_password_if_offline: &#39;true&#39;

profiles::auth::client::krb5_options:
  libdefaults:
    default_realm:    &quot;%{hiera(&#39;krb5_realm&#39;)}&quot;
    rdns:             &#39;false&#39;
    dns_lookup_realm: &#39;false&#39;
    dns_lookup_kdc:   &#39;false&#39;
    forwardable:      &#39;true&#39;
  realms:
    &quot;%{hiera(&#39;krb5_realm&#39;)}&quot;: |-
      {
        kdc = %{hiera(&#39;kdc_primary&#39;)}
        kdc = %{hiera(&#39;kdc_secondary&#39;)}
        admin_server = %{hiera(&#39;ldap_external&#39;)}
        kpasswd_server = %{hiera(&#39;ldap_external&#39;)}
        default_domain = example.com
      }
  domain_realm:
    &#39;.EXAMPLE.COM&#39;: &quot;%{hiera(&#39;krb5_realm&#39;)}&quot;
    &#39;EXAMPLE.COM&#39;:  &quot;%{hiera(&#39;krb5_realm&#39;)}&quot;

kerberos::keytab_source_dir: &quot;%{hiera(&#39;private_files_dir&#39;)}/auth/keytabs&quot;
kerberos::decrypt_passwd:    &quot;%{hiera(&#39;cluster_decrypt_password&#39;)}&quot;
</code></pre>

<h2>Hiera</h2>

<ul>
<li><code>cluster_name</code></li>
<li><code>profiles::auth::client::enable_kerberos</code></li>
<li><code>profiles::auth::client::krb5_server</code></li>
<li><code>profiles::auth::client::krb5_realm</code></li>
<li><code>profiles::auth::client::krb5_store_password_if_offline</code></li>
<li><code>profiles::auth::client::sssd_options_general</code> (<code>hiera_hash</code>)</li>
<li><code>profiles::auth::client::sssd_options_nss</code> (<code>hiera_hash</code>)</li>
<li><code>profiles::auth::client::sssd_options_pam</code> (<code>hiera_hash</code>)</li>
<li><code>profiles::auth::client::sssd_options_domain</code> (<code>hiera_hash</code>)</li>
<li><code>profiles::auth::client::external_ldap</code> (default value: false)</li>
<li><code>profiles::auth::client::ldap_external_uri</code></li>
<li><code>profiles::auth::client::ldap_internal_uri</code></li>
<li><code>profiles::auth::client::krb5_options</code> (<code>hiera_hash</code>)</li>
</ul>

<h2>Relevant Autolookup</h2>

<ul>
<li><code>kerberos::keytab_source_dir</code> Directory where the keytabs are sourced (with <code>hpclib::decrypt</code>)</li>
<li><code>kerberos::decrypt_passwd</code>    Password to decrypt keytabs (with <code>hpclib::decrypt</code>)</li>
</ul>
</p>
  </div>
</div>
<div class="tags">
  
  
  
</div>
</div>

    <div id="footer">
  Generated on Mon Jan 16 17:43:39 2017 by
  <a href="http://yardoc.org" title="Yay! A Ruby Documentation Tool" target="_parent">yard</a>
  0.8.7.4 (ruby-2.1.5).
</div>

  </body>
</html>